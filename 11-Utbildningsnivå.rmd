# Utbildningsnivå

Befolkning efter region, ålder, utbildningsnivå, kön och år
ålder 16-74 år
kön män och kvinnor
år 2017

```{r edudist, echo = TRUE, fig.cap = 'Education distribution in the different countys'} 
utb <- readfile("UF0506A1.csv") 
utb$utbildningsnivå <- as.factor(utb$utbildningsnivå)
utb$utbildningsnivå <- factor(utb$utbildningsnivå, levels(utb$utbildningsnivå)[c(3, 1, 2, 6, 7, 5, 4, 8)])
utb %>%
  filter (utbildningsnivå != "uppgift om utbildningsnivå saknas") %>%
  mutate(lnkod_n = substr(region, 1,2)) %>%
  ggplot(aes(x = lnkod_n, y = salary, fill = utbildningsnivå)) +
    geom_col(position = "fill") +
    theme(legend.position="bottom") +
    facet_grid(. ~ kön)	
```

```{r utbildningsniva, echo = TRUE, fig.cap = 'Percentage of the population who have 3 years or more post-secondary education, but not postgraduate education.'} 
readfile("UF0506A1.csv") %>%
  group_by(utbildningsnivå, region) %>%
  summarize(utbregno = sum(salary)) %>%
  group_by(region) %>% mutate(perc = utbregno / sum(utbregno)) %>%
  filter (utbildningsnivå == "eftergymnasial utbildning, 3 år eller mer") %>%
  mutate(lnkod_n = as.numeric(substr(region, 1,2))) %>%
  right_join(map_ln_n, by = "lnkod_n") %>%
  ggplot() +
    geom_polygon(mapping = aes(x = ggplot_long, y = ggplot_lat, group = lnkod, fill = perc)) +
    coord_equal()
```
	
```{r utbildningsniva2, echo = TRUE, fig.cap = 'The correlation between the proportion of the population who have 3 years or more post-secondary education, but not postgraduate education, and the salaries of engineers in the region.'} 	
readfile("UF0506A1.csv") %>%
  group_by(utbildningsnivå, region) %>%
  summarize(utbregno = sum(salary)) %>%
  group_by(region) %>% mutate(perc = utbregno / sum(utbregno)) %>%
  filter (utbildningsnivå == "eftergymnasial utbildning, 3 år eller mer") %>%
  mutate(lnkod_n = as.numeric(substr(region, 1,2))) %>%
  right_join(salary_2017, by = c("lnkod_n" = "Länskod")) %>%
  ggscatter(x = "relsalary", y = "perc", 
    add = "reg.line", conf.int = TRUE, 
    cor.coef = TRUE, cor.method = "pearson")   
```	

## The correlation between the proportion of engineers who are women and the number of the population who have 3 years or more post-secondary education in the region. Year 2014 - 2018
Average basic salary, monthly salary and women´s salary as a percentage of men´s salary by region, sector, occupational group (SSYK 2012) and sex . Year 2014 - 2018
Monthly salaty
All sectors
214 Engineering professionals

Average basic salary, monthly salary and women´s salary as a percentage of men´s salary by region, sector, occupational group (SSYK 2012) and sex . Year 2014 - 2018
Number of employees
All sectors
214 Engineering professionals

Population 16-74 years of age by region, highest level of education, age and sex. Year 1985 - 2018
total 16-74 years

```{r utbildningsniva3, echo = TRUE, fig.cap = 'The correlation between the proportion of engineers who are women and the number of the population who have 3 years or more post-secondary education, but not postgraduate education in the regions (NUTS2), Year 2014 - 2018.'} 	
tb <- readfile("000000CG_10.csv")
tb <- readfile("000000CD_10.csv") %>% 
  left_join(tb, by = c("region", "year", "sex")) %>%
  group_by (`region`, year) %>%   
  mutate (perc_women = as.numeric (sub ("%", "", perc_women (salary.x)))) %>%
  mutate (perc_salary = as.numeric (sub ("%", "", perc_sal (salary.y)))) %>%
  mutate (sum_ing = sum(salary.x))  
readfile("UF0506A1_1.csv") %>%
  group_by(`level of education`, region, year, sex) %>%
  mutate(utbregno = sum(salary)) %>%
  group_by(region, year, sex) %>% mutate(perc_edu = utbregno / sum(utbregno)) %>%
  group_by(`level of education`, region, year) %>%
  mutate (sum_edu = sum(utbregno)) %>%
  filter (`level of education` == "post-secondary education 3 years or more (ISCED97 5A)") %>%
  right_join(tb, by = c("region", "year", "sex")) %>%
  mutate (perc_eng = sum_ing / sum_edu) %>%
  ggplot(aes(x = sum_edu, y = perc_women, colour = region, size = year2)) +
  geom_point() +
  theme(legend.position="bottom")
```

```{r utbildningsniva4, echo = TRUE, fig.cap = 'The correlation between the proportion of engineers who are women and the number of the population who have 3 years or more post-secondary education, but not postgraduate education in the regions (NUTS2), Year 2014 - 2018.'} 	
tb <- readfile("000000CG_10.csv")
tb <- readfile("000000CD_10.csv") %>% 
  left_join(tb, by = c("region", "year", "sex")) %>%
  group_by (`region`, year) %>%   
  mutate (perc_women = as.numeric (sub ("%", "", perc_women (salary.x)))) %>%
  mutate (perc_salary = as.numeric (sub ("%", "", perc_sal (salary.y)))) %>%
  mutate (sum_ing = sum(salary.x))  
readfile("UF0506A1_1.csv") %>%
  group_by(`level of education`, region, year, sex) %>%
  mutate(utbregno = sum(salary)) %>%
  group_by(region, year, sex) %>% mutate(perc_edu = utbregno / sum(utbregno)) %>%
  group_by(`level of education`, region, year) %>%
  mutate (sum_edu = sum(utbregno)) %>%
  filter (`level of education` == "post-secondary education 3 years or more (ISCED97 5A)") %>%
  right_join(tb, by = c("region", "year", "sex")) %>%
  mutate (perc_eng = sum_ing / sum_edu) %>%
  ggscatter(x = "sum_edu", y = "perc_women", 
  add = "reg.line", conf.int = TRUE, 
  cor.coef = TRUE, cor.method = "pearson")
```

## The correlation between the number of engineers and the number of the population who have 3 years or more post-secondary education in the regions, Year 2014 - 2018.

```{r utbildningsniva5, echo = TRUE, fig.cap = 'The correlation between the number of engineers and the number of the population who have 3 years or more post-secondary education, but not postgraduate education in the regions (NUTS2), Year 2014 - 2018.'} 	
tb <- readfile("000000CG_10.csv")
tb <- readfile("000000CD_10.csv") %>% 
  left_join(tb, by = c("region", "year", "sex")) %>%
  group_by (`region`, year) %>%   
  mutate (perc_women = as.numeric (sub ("%", "", perc_women (salary.x)))) %>%
  mutate (perc_salary = as.numeric (sub ("%", "", perc_sal (salary.y)))) %>%
  mutate (sum_ing = sum(salary.x))  
readfile("UF0506A1_1.csv") %>%
  group_by(`level of education`, region, year, sex) %>%
  mutate(utbregno = sum(salary)) %>%
  group_by(region, year, sex) %>% mutate(perc_edu = utbregno / sum(utbregno)) %>%
  group_by(`level of education`, region, year) %>%
  mutate (sum_edu = sum(utbregno)) %>%
  filter (`level of education` == "post-secondary education 3 years or more (ISCED97 5A)") %>%
  right_join(tb, by = c("region", "year", "sex")) %>%
  mutate (perc_eng = sum_ing / sum_edu) %>%
  ggplot(aes(x = sum_edu, y = sum_ing, colour = region, size = year2)) +
  geom_point() +
  theme(legend.position="bottom")
```

```{r utbildningsniva6, echo = TRUE, fig.cap = 'The correlation between the number of engineers and the number of the population who have 3 years or more post-secondary education, but not postgraduate education in the regions (NUTS2), Year 2014 - 2018.'} 	
tb <- readfile("000000CG_10.csv")
tb <- readfile("000000CD_10.csv") %>% 
  left_join(tb, by = c("region", "year", "sex")) %>%
  group_by (`region`, year) %>%   
  mutate (perc_women = as.numeric (sub ("%", "", perc_women (salary.x)))) %>%
  mutate (perc_salary = as.numeric (sub ("%", "", perc_sal (salary.y)))) %>%
  mutate (sum_ing = sum(salary.x))  
readfile("UF0506A1_1.csv") %>%
  group_by(`level of education`, region, year, sex) %>%
  mutate(utbregno = sum(salary)) %>%
  group_by(region, year, sex) %>% mutate(perc_edu = utbregno / sum(utbregno)) %>%
  group_by(`level of education`, region, year) %>%
  mutate (sum_edu = sum(utbregno)) %>%
  filter (`level of education` == "post-secondary education 3 years or more (ISCED97 5A)") %>%
  right_join(tb, by = c("region", "year", "sex")) %>%
  mutate (perc_eng = sum_ing / sum_edu) %>%
  ggscatter(x = "sum_edu", y = "sum_ing", 
  add = "reg.line", conf.int = TRUE, 
  cor.coef = TRUE, cor.method = "pearson")
```

## The correlation between the number of engineers and the number of the population who have 3 years or more post-secondary education in the regions, Year 2014 - 2018

```{r utbildningsniva7, echo = TRUE, fig.cap = 'The correlation between the number of engineers and the number of the population who have 3 years or more post-secondary education, but not postgraduate education in the regions (NUTS2), Year 2014 - 2018.'} 	
tb <- readfile("000000CG_10.csv")
tb <- readfile("000000CD_10.csv") %>% 
  left_join(tb, by = c("region", "year", "sex")) %>%
  group_by (`region`, year) %>%   
  mutate (perc_women = as.numeric (sub ("%", "", perc_women (salary.x)))) %>%
  mutate (perc_salary = as.numeric (sub ("%", "", perc_sal (salary.y)))) %>%
  mutate (sum_ing = sum(salary.x))  
readfile("UF0506A1_1.csv") %>%
  group_by(`level of education`, region, year, sex) %>%
  group_by(`level of education`, region, year, sex) %>%
  mutate(utbregno = sum(salary)) %>%
  group_by(region, year, sex) %>% mutate(perc_edu = utbregno / sum(utbregno)) %>%
  group_by(`level of education`, region, year) %>%
  mutate (sum_edu = sum(utbregno)) %>%
  filter (`level of education` == "post-secondary education 3 years or more (ISCED97 5A)") %>%
  right_join(tb, by = c("region", "year", "sex")) %>%
  mutate (perc_eng = sum_ing / sum_edu) %>%
  ggplot(aes(x = perc_women, y = sum_ing, colour = region, size = year2)) +
  geom_point() +
  theme(legend.position="bottom")
```

```{r utbildningsniva8, echo = TRUE, fig.cap = 'The correlation between the number of engineers and the number of the population who have 3 years or more post-secondary education, but not postgraduate education in the regions (NUTS2), Year 2014 - 2018.'} 	
tb <- readfile("000000CG_10.csv")
tb <- readfile("000000CD_10.csv") %>% 
  left_join(tb, by = c("region", "year", "sex")) %>%
  group_by (`region`, year) %>%   
  mutate (perc_women = as.numeric (sub ("%", "", perc_women (salary.x)))) %>%
  mutate (perc_salary = as.numeric (sub ("%", "", perc_sal (salary.y)))) %>%
  mutate (sum_ing = sum(salary.x))  
readfile("UF0506A1_1.csv") %>%
  group_by(`level of education`, region, year, sex) %>%
  group_by(`level of education`, region, year, sex) %>%
  mutate(utbregno = sum(salary)) %>%
  group_by(region, year, sex) %>% mutate(perc_edu = utbregno / sum(utbregno)) %>%
  group_by(`level of education`, region, year) %>%
  mutate (sum_edu = sum(utbregno)) %>%
  filter (`level of education` == "post-secondary education 3 years or more (ISCED97 5A)") %>%
  right_join(tb, by = c("region", "year", "sex")) %>%
  mutate (perc_eng = sum_ing / sum_edu) %>%
  ggscatter(x = "perc_women", y = "sum_ing", 
  add = "reg.line", conf.int = TRUE, 
  cor.coef = TRUE, cor.method = "pearson")
```

## The correlation between the number of engineers and the number of the population who have 3 years or more post-secondary education in the regions, Year 2014 - 2018

```{r utbildningsniva9, echo = TRUE, fig.cap = 'The correlation between the number of engineers and the number of the population who have 3 years or more post-secondary education, but not postgraduate education in the regions (NUTS2), Year 2014 - 2018.'} 	
tb <- readfile("000000CG_10.csv")
tb <- readfile("000000CD_10.csv") %>% 
  left_join(tb, by = c("region", "year", "sex")) %>%
  group_by (`region`, year) %>%   
  mutate (perc_women = as.numeric (sub ("%", "", perc_women (salary.x)))) %>%
  mutate (perc_salary = as.numeric (sub ("%", "", perc_sal (salary.y)))) %>%
  mutate (sum_ing = sum(salary.x))  
readfile("UF0506A1_1.csv") %>%
  group_by(`level of education`, region, year, sex) %>%
  mutate(utbregno = sum(salary)) %>%
  group_by(region, year, sex) %>% mutate(perc_edu = utbregno / sum(utbregno)) %>%
  group_by(`level of education`, region, year) %>%
  mutate (sum_edu = sum(utbregno)) %>%
  filter (`level of education` == "post-secondary education 3 years or more (ISCED97 5A)") %>%
  right_join(tb, by = c("region", "year", "sex")) %>%
  mutate (perc_eng = sum_ing / sum_edu) %>%
  ggplot(aes(x = sum_edu, y = salary.y, colour = region, size = year2)) +
  geom_point() +
  theme(legend.position="bottom") +
  facet_grid(. ~ sex)
```

```{r utbildningsniva10, echo = TRUE, fig.cap = 'The correlation between the number of engineers and the number of the population who have 3 years or more post-secondary education, but not postgraduate education in the regions (NUTS2), Year 2014 - 2018.'} 	
tb <- readfile("000000CG_10.csv")
tb <- readfile("000000CD_10.csv") %>% 
  left_join(tb, by = c("region", "year", "sex")) %>%
  group_by (`region`, year) %>%   
  mutate (perc_women = as.numeric (sub ("%", "", perc_women (salary.x)))) %>%
  mutate (perc_salary = as.numeric (sub ("%", "", perc_sal (salary.y)))) %>%
  mutate (sum_ing = sum(salary.x))  
readfile("UF0506A1_1.csv") %>%
  group_by(`level of education`, region, year, sex) %>%
  mutate(utbregno = sum(salary)) %>%
  group_by(region, year, sex) %>% mutate(perc_edu = utbregno / sum(utbregno)) %>%
  group_by(`level of education`, region, year) %>%
  mutate (sum_edu = sum(utbregno)) %>%
  filter (`level of education` == "post-secondary education 3 years or more (ISCED97 5A)") %>%
  right_join(tb, by = c("region", "year", "sex")) %>%
  mutate (perc_eng = sum_ing / sum_edu) %>%
  ggscatter(x = "sum_edu", y = "salary.y", 
  add = "reg.line", conf.int = TRUE, 
  cor.coef = TRUE, cor.method = "pearson")
```

## The correlation between the propotion of the population who have 3 years or more post-secondary education and the number of the population who have 3 years or more post-secondary education in the regions, Year 2014 - 2018

```{r utbildningsniva11, echo = TRUE, fig.cap = 'The correlation between the propotion of the population who have 3 years or more post-secondary education, but not postgraduate education and the number of the population who have 3 years or more post-secondary education, but not postgraduate education in the regions (NUTS2), Year 2014 - 2018.'} 	
tb <- readfile("000000CG_10.csv")
tb <- readfile("000000CD_10.csv") %>% 
  left_join(tb, by = c("region", "year", "sex")) %>%
  group_by (`region`, year) %>%   
  mutate (perc_women = as.numeric (sub ("%", "", perc_women (salary.x)))) %>%
  mutate (perc_salary = as.numeric (sub ("%", "", perc_sal (salary.y)))) %>%
  mutate (sum_ing = sum(salary.x))  
readfile("UF0506A1_1.csv") %>%
  group_by(`level of education`, region, year, sex) %>%
  mutate(utbregno = sum(salary)) %>%
  group_by(region, year, sex) %>% mutate(perc_edu = utbregno / sum(utbregno)) %>%
  group_by(`level of education`, region, year) %>%
  mutate (sum_edu = sum(utbregno)) %>%
  filter (`level of education` == "post-secondary education 3 years or more (ISCED97 5A)") %>%
  right_join(tb, by = c("region", "year", "sex")) %>%
  mutate (perc_eng = sum_ing / sum_edu) %>%
  ggplot(aes(x = perc_edu, y = salary, colour = region, size = year2)) +
  geom_point() +
  theme(legend.position="bottom") +
  facet_grid(. ~ sex)
```