<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on R Analystatistics Sweden</title>
    <link>/post/</link>
    <description>Recent content in Posts on R Analystatistics Sweden</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Mon, 02 Dec 2019 00:00:00 +0000</lastBuildDate>
    
        <atom:link href="/post/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>The significance of experience on the salary in Sweden, a comparison between different occupational groups</title>
      <link>/2019/12/02/the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups/</link>
      <pubDate>Mon, 02 Dec 2019 00:00:00 +0000</pubDate>
      
      <guid>/2019/12/02/the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups/</guid>
      <description>`


&lt;p&gt;In my last post, I found that experience has a significant impact on the salary of engineers. Is the significance of experience on wages unique to engineers or are there similar correlations in other occupational groups?&lt;/p&gt;
&lt;p&gt;I will use the same model in principal as in my previous post to calculate the significance of age. I will not use sex as an explanatory variable since there are occupational groups that do not have enough data for both genders. I will also use a polynomial of degree three since this provides a significant model fit for some occupational groups.&lt;/p&gt;
&lt;p&gt;There are still occupational groups with too little data for regression analysis. More than 30 posts are necessary to fit both age and year.&lt;/p&gt;
&lt;p&gt;The R-value from the Anova table is used as the single value to discriminate how much the age and salary correlates. For exploratory analysis, the Anova value seems good enough.&lt;/p&gt;
&lt;p&gt;In the figure below I will also use the estimate for the year to see how much the salaries are raised each year for the different occupational groups holding age as constant.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (tidyverse)
## -- Attaching packages -------------------------------------------- tidyverse 1.2.1 --
## v ggplot2 3.2.0     v purrr   0.3.2
## v tibble  2.1.3     v dplyr   0.8.3
## v tidyr   0.8.3     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0
## -- Conflicts ----------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
library (broom)
library (car)
## Loading required package: carData
## 
## Attaching package: &amp;#39;car&amp;#39;
## The following object is masked from &amp;#39;package:dplyr&amp;#39;:
## 
##     recode
## The following object is masked from &amp;#39;package:purrr&amp;#39;:
## 
##     some
library (polynom)

readfile &amp;lt;- function (file1){read_csv (file1, col_types = cols(), locale = readr::locale (encoding = &amp;quot;latin1&amp;quot;), na = c(&amp;quot;..&amp;quot;, &amp;quot;NA&amp;quot;)) %&amp;gt;%
  gather (starts_with(&amp;quot;19&amp;quot;), starts_with(&amp;quot;20&amp;quot;), key = &amp;quot;year&amp;quot;, value = salary) %&amp;gt;%
  drop_na() %&amp;gt;%
  mutate (year_n = parse_number (year))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The data table is downloaded from Statistics Sweden. It is saved as a comma-delimited file without heading, 000000D2.csv, &lt;a href=&#34;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&#34; class=&#34;uri&#34;&gt;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The table: Average basic salary, monthly salary and women´s salary as a percentage of men´s salary by sector, occupational group (SSYK 2012), sex and age. Year 2014 - 2018 Monthly salary All sectors&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb &amp;lt;- readfile(&amp;quot;000000D2.csv&amp;quot;) %&amp;gt;%
  rowwise() %&amp;gt;%
  mutate(age_l = unlist(lapply(strsplit(substr(age, 1, 5), &amp;quot;-&amp;quot;), strtoi))[1]) %&amp;gt;%
  rowwise() %&amp;gt;%
  mutate(age_h = unlist(lapply(strsplit(substr(age, 1, 5), &amp;quot;-&amp;quot;), strtoi))[2]) %&amp;gt;%
  mutate(age_n = (age_l + age_h) / 2)

summary_table = 0
anova_table = 0

for (i in unique(tb$`occuptional  (SSYK 2012)`)){
  temp &amp;lt;- filter(tb, `occuptional  (SSYK 2012)` == i)
  if (dim(temp)[1] &amp;gt; 30){
    model &amp;lt;-lm (log(salary) ~ year_n + poly(age_n, 3), data = temp)
    summary_table &amp;lt;- rbind (summary_table, mutate (tidy (summary (model)), ssyk = i))
    anova_table &amp;lt;- rbind (anova_table, mutate (tidy (Anova (model, type = 2)), ssyk = i))
  }
}

merge(summary_table, anova_table, by = &amp;quot;ssyk&amp;quot;, all = TRUE) %&amp;gt;%
  filter (term.y == &amp;quot;poly(age_n, 3)&amp;quot;) %&amp;gt;%
  filter (term.x == &amp;quot;year_n&amp;quot;) %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = estimate, y = statistic.y)) +
    labs(
      x = &amp;quot;Increase in salaries (% / year)&amp;quot;,
      y = &amp;quot;F-value for age&amp;quot;
    ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-2&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-2-1.png&#34; alt=&#34;The significance of experience on the salary in Sweden, a comparison between different occupational groups, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: The significance of experience on the salary in Sweden, a comparison between different occupational groups, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The table with all occupational groups sorted by F-value in descending order.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;merge(summary_table, anova_table, by = &amp;quot;ssyk&amp;quot;, all = TRUE) %&amp;gt;%
  filter (term.y == &amp;quot;poly(age_n, 3)&amp;quot;) %&amp;gt;%
  filter (term.x == &amp;quot;year_n&amp;quot;) %&amp;gt;%
  select (ssyk, estimate, statistic.y) %&amp;gt;%
  rename (`F-value for age` = statistic.y) %&amp;gt;%
  rename (`Increase in salary` = estimate) %&amp;gt;%
  arrange (desc (`F-value for age`)) %&amp;gt;%
  knitr::kable(
    booktabs = TRUE,
    caption = &amp;#39;Correlation for F-value (age) and the yearly increase in salaries with age held as constant&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;Correlation for F-value (age) and the yearly increase in salaries with age held as constant&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;ssyk&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Increase in salary&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;F-value for age&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;234 Primary- and pre-school teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0345563&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1349.859088&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;233 Secondary education teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0294574&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;861.331070&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;532 Personal care workers in health services&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0285338&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;800.259659&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;336 Police officers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0284911&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;675.571576&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;223 Nursing professionals (cont.)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0303955&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;625.404523&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;214 Engineering professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0192393&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;612.414362&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;235 Teaching professionals not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0245885&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;578.686817&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;266 Social work and counselling professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0316617&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;551.888399&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;221 Medical doctors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0150176&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;449.792500&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;251 ICT architects, systems analysts and test managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0249600&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;415.590103&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;534 Attendants, personal assistants and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0191811&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;406.258604&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;231 University and higher education teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0254827&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;404.602202&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;222 Nursing professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0414071&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;371.107319&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;533 Health care assistants&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0205813&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;345.075594&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;531 Child care workers and teachers aides&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0219044&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;291.049608&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;351 ICT operations and user support technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0211211&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;271.091961&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;159 Other social services managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0251218&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;191.570380&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;211 Physicists and chemists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0207272&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;186.366824&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;321 Medical and pharmaceutical technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0288946&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;177.137635&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;152 Managers in social and curative care&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0387001&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;164.636802&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;243 Marketing and public relations professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0150173&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;154.310784&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;723 Machinery mechanics and fitters&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0204993&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;146.299981&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;125 Sales and marketing managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0187356&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;145.732333&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;141 Primary and secondary schools and adult education managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0346753&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;142.578762&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;341 Social work and religious associate professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0255830&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;137.073911&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;133 Research and development managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0137728&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;135.323107&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;153 Elderly care managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0331514&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;132.163025&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;242 Organisation analysts, policy administrators and human resource specialists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0223881&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;132.013557&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;332 Insurance advisers, sales and purchasing agents&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0176134&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;128.196288&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;218 Specialists within environmental and health protection&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0258110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;120.206634&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;311 Physical and engineering science technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0213202&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;119.371812&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;422 Client information clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0175877&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;117.057208&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;411 Office assistants and other secretaries&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0250406&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;115.401389&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;264 Authors, journalists and linguists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0158766&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;107.667527&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;226 Dentists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0230213&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;99.061845&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;232 Vocational education teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0298647&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93.534293&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;122 Human resource managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0365348&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86.595103&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;342 Athletes, fitness instructors and recreational workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0162825&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86.085107&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;515 Building caretakers and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0188443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85.346469&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;123 Administration and planning managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0423650&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81.886461&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;137 Production managers in manufacturing&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0267995&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80.958767&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;227 Naprapaths, physiotherapists, occupational therapists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0212967&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;78.930141&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;132 Supply, logistics and transport managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0135557&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;78.186301&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;817 Wood processing and papermaking plant operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0289197&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75.983376&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;441 Library and filing clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0210449&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75.872685&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;131 Information and communications technology service managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0431537&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75.423080&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;343 Photographers, interior decorators and entertainers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0339142&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75.132287&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;241 Accountants, financial analysts and fund managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0270620&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;71.204029&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;216 Architects and surveyors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0241267&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;68.945982&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;134 Architectural and engineering managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0236760&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;68.279874&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;228 Specialists in health care not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0272838&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;64.426085&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;213 Biologists, pharmacologists and specialists in agriculture and forestry&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0144849&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63.378555&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;831 Train operators and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0177987&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;55.404356&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;334 Administrative and specialized secretaries&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0292702&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;52.477105&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;335 Tax and related government associate professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0227003&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;49.850281&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;224 Psychologists and psychotherapists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0270655&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47.653074&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;511 Cabin crew, guides and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0069736&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47.413185&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;812 Metal processing and finishing plant operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0176743&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47.395879&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;331 Financial and accounting associate professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0229113&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45.186053&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;261 Legal professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0292942&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;44.569161&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;819 Process control technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0232825&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.919550&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;333 Business services agents&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0263028&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.327180&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;961 Recycling collectors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0225031&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;42.772133&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;312 Construction and manufacturing supervisors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0322029&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41.767797&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;516 Other service related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0202784&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41.325733&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;262 Museum curators and librarians and related professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0228651&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40.378111&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;265 Creative and performing artists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0252235&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39.119906&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;741 Electrical equipment installers and repairers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0221901&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38.176541&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;524 Event seller and telemarketers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0203373&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36.349688&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;941 Fast-food workers, food preparation assistants&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0199578&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;35.998201&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;815 Machine operators, textile, fur and leather products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0128372&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33.582965&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;962 Newspaper distributors, janitors and other service workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0141958&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;32.540073&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;136 Production managers in construction and mining&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0264825&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31.006282&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;834 Mobile plant operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0251599&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30.439935&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;816 Machine operators, food and related products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0198706&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.543569&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;129 Administration and service managers not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0171682&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.032377&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;212 Mathematicians, actuaries and statisticians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0240773&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.949679&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;352 Broadcasting and audio-visual technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0067079&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.725776&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;513 Waiters and bartenders&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0214795&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.455515&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;813 Machine operators, chemical and pharmaceutical products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0254550&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26.563325&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;151 Health care managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0211530&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.870942&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;611 Market gardeners and crop growers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0089573&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.602904&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;732 Printing trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0191704&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.581610&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;432 Stores and transport clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0217702&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.969527&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;217 Designers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0252062&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.823943&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;161 Financial and insurance managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0518758&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.908728&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;711 Carpenters, bricklayers and construction workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0136555&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.268520&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;541 Other surveillance and security workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0239438&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.245270&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;179 Other services managers not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0272448&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.108091&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;911 Cleaners and helpers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0176513&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.284355&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;512 Cooks and cold-buffet managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0278549&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.787404&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;814 Machine operators, rubber, plastic and paper products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0245275&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.256042&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;267 Religious professionals and deacons&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0268407&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.266331&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;761 Butchers, bakers and food processors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0153660&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.168879&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;722 Blacksmiths, toolmakers and related trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0192713&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.890741&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;121 Finance managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0276643&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.785317&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;752 Wood treaters, cabinet-makers and related trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0269102&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.779896&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;713 Painters, Lacquerers, Chimney-sweepers and related trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0259098&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.415854&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;932 Manufacturing labourers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0266336&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.113769&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;522 Shop staff&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0267679&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.247675&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;818 Other stationary plant and machine operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0237780&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.983074&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;344 Driving instructors and other instructors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0286480&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.971261&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;523 Cashiers and related clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0041737&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.970851&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;833 Heavy truck and bus drivers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0188392&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.786235&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;912 Washers, window cleaners and other cleaning workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0382761&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.701424&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;821 Assemblers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0286219&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.405402&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Let’s check what we have found.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tb %&amp;gt;%
  filter(`occuptional  (SSYK 2012)` == &amp;quot;234 Primary- and pre-school teachers&amp;quot;)
 
temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = age)) +
    facet_grid(. ~ sex) +   
    labs(
      x = &amp;quot;Year&amp;quot;,
      y = &amp;quot;Salary (SEK/month)&amp;quot;
    ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-4&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-4-1.png&#34; alt=&#34;Highest F-value, Primary- and pre-school teachers&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Highest F-value, Primary- and pre-school teachers
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;-lm (log(salary) ~ year_n + poly(age_n, 3, raw = T), data = temp)

summod &amp;lt;- tidy(summary (model))

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = age_n,y = age_n * summod$estimate[3] + summod$estimate[4] * age_n^2 + summod$estimate[5] * age_n^3)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-5&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-5-1.png&#34; alt=&#34;Model fit, Primary- and pre-school teachers, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Model fit, Primary- and pre-school teachers, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pdx &amp;lt;- deriv(as.polynomial(c(0, summod$estimate[3], summod$estimate[4], summod$estimate[5])))

temp %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n, y = summod$estimate[2] + pdx[1] + pdx[2] * age_n + pdx[3] * age_n^2)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary raise (%)&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-6&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-6-1.png&#34; alt=&#34;Model fit, Primary- and pre-school teachers, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Model fit, Primary- and pre-school teachers, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tb %&amp;gt;%
  filter(`occuptional  (SSYK 2012)` == &amp;quot;821 Assemblers&amp;quot;)

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = age)) +
    facet_grid(. ~ sex) +   
    labs(
      x = &amp;quot;Year&amp;quot;,
      y = &amp;quot;Salary (SEK/month)&amp;quot;
    ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-7&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-7-1.png&#34; alt=&#34;Lowest F-value, Assemblers&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Lowest F-value, Assemblers
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;-lm (log(salary) ~ year_n + poly(age_n, 3, raw = T), data = temp)

summod &amp;lt;- tidy(summary (model))

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = age_n,y = age_n * summod$estimate[3] + summod$estimate[4] * age_n^2 + summod$estimate[5] * age_n^3)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-8&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-8-1.png&#34; alt=&#34;Model fit, Assemblers, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 6: Model fit, Assemblers, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pdx &amp;lt;- deriv(as.polynomial(c(0, summod$estimate[3], summod$estimate[4], summod$estimate[5])))

temp %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n, y = summod$estimate[2] + pdx[1] + pdx[2] * age_n + pdx[3] * age_n^2)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary raise (%)&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-9&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-9-1.png&#34; alt=&#34;Model fit, Assemblers, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 7: Model fit, Assemblers, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tb %&amp;gt;%
  filter(`occuptional  (SSYK 2012)` == &amp;quot;161 Financial and insurance managers&amp;quot;)

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = age)) +
    facet_grid(. ~ sex) + 
      labs(
        x = &amp;quot;Year&amp;quot;,
        y = &amp;quot;Salary (SEK/month)&amp;quot;
      ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-10&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-10-1.png&#34; alt=&#34;Highest yearly salary increase, Financial and insurance managers&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 8: Highest yearly salary increase, Financial and insurance managers
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;- lm (log(salary) ~ year_n + poly(age_n, 3, raw = T), data = temp)

summod &amp;lt;- tidy(summary (model))

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = age_n,y = age_n * summod$estimate[3] + summod$estimate[4] * age_n^2 + summod$estimate[5] * age_n^3)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-11&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-11-1.png&#34; alt=&#34;Model fit, Financial and insurance managers, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 9: Model fit, Financial and insurance managers, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pdx &amp;lt;- deriv(as.polynomial(c(0, summod$estimate[3], summod$estimate[4], summod$estimate[5])))

temp %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n, y = summod$estimate[2] + pdx[1] + pdx[2] * age_n + pdx[3] * age_n^2)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary raise (%)&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-12&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-12-1.png&#34; alt=&#34;Model fit, Financial and insurance managers, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 10: Model fit, Financial and insurance managers, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tb %&amp;gt;%
  filter(`occuptional  (SSYK 2012)` == &amp;quot;523 Cashiers and related clerks&amp;quot;)
temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = age)) +
    facet_grid(. ~ sex) + 
    labs(
      x = &amp;quot;Year&amp;quot;,
      y = &amp;quot;Salary (SEK/month)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-13&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-13-1.png&#34; alt=&#34;Lowest yearly salary increase, Cashiers and related clerks&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 11: Lowest yearly salary increase, Cashiers and related clerks
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;-lm (log(salary) ~ year_n + poly(age_n, 3, raw = T), data = temp)

summod &amp;lt;- tidy(summary (model))

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = age_n,y = age_n * summod$estimate[3] + summod$estimate[4] * age_n^2 + summod$estimate[5] * age_n^3)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-14&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-14-1.png&#34; alt=&#34;Model fit, Cashiers and related clerks, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 12: Model fit, Cashiers and related clerks, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pdx &amp;lt;- deriv(as.polynomial(c(0, summod$estimate[3], summod$estimate[4], summod$estimate[5])))

temp %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n, y = summod$estimate[2] + pdx[1] + pdx[2] * age_n + pdx[3] * age_n^2)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary raise (%)&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-15&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-15-1.png&#34; alt=&#34;Model fit, Cashiers and related clerks, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 13: Model fit, Cashiers and related clerks, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a href=&#34;https://www.r-bloggers.com/&#34; class=&#34;uri&#34;&gt;https://www.r-bloggers.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://rweekly.org&#34; class=&#34;uri&#34;&gt;https://rweekly.org&lt;/a&gt;&lt;/p&gt;
`</description>
    </item>
    
    <item>
      <title>The significance of experience on the salary of engineers in Sweden</title>
      <link>/2019/11/22/the-significance-of-experience-on-the-salary-of-engineers-in-sweden/</link>
      <pubDate>Fri, 22 Nov 2019 00:00:00 +0000</pubDate>
      
      <guid>/2019/11/22/the-significance-of-experience-on-the-salary-of-engineers-in-sweden/</guid>
      <description>`


&lt;p&gt;What causes the salary to change during the working life of engineers in Sweden?&lt;/p&gt;
&lt;p&gt;I will examine data from Statistics Sweden to see what information you can interpret from it.&lt;/p&gt;
&lt;p&gt;Statistics Sweden is the Swedish government agency responsible for producing official statistics regarding Sweden, &lt;a href=&#34;https://www.scb.se/en/&#34; class=&#34;uri&#34;&gt;https://www.scb.se/en/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;“Everybody should have the opportunity to find facts and break the myths with our statistics!” Statistics Sweden twitter account, sverigeisiffror.&lt;/p&gt;
&lt;p&gt;Salaries are reported for every occupational group SSYK (Standard for Swedish occupational classification). I will examine SSYK 214, architects, engineers and related professionals.&lt;/p&gt;
&lt;p&gt;First, define libraries and functions.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (tidyverse) 
## -- Attaching packages -------------------------------------------- tidyverse 1.2.1 --
## v ggplot2 3.2.0     v purrr   0.3.2
## v tibble  2.1.3     v dplyr   0.8.3
## v tidyr   0.8.3     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0
## -- Conflicts ----------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
library (broom) 
library (car)
## Loading required package: carData
## 
## Attaching package: &amp;#39;car&amp;#39;
## The following object is masked from &amp;#39;package:dplyr&amp;#39;:
## 
##     recode
## The following object is masked from &amp;#39;package:purrr&amp;#39;:
## 
##     some
library (splines)
#install_github(&amp;quot;ZheyuanLi/SplinesUtils&amp;quot;)
library(SplinesUtils)

readfile &amp;lt;- function (file1){  
  read_csv (file1, col_types = cols(), locale = readr::locale (encoding = &amp;quot;latin1&amp;quot;), na = c(&amp;quot;..&amp;quot;, &amp;quot;NA&amp;quot;)) %&amp;gt;%  
    gather (starts_with(&amp;quot;19&amp;quot;), starts_with(&amp;quot;20&amp;quot;), key = &amp;quot;year&amp;quot;, value = salary) %&amp;gt;%  
    drop_na() %&amp;gt;%  
    mutate (year_n = parse_number (year))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The data table is downloaded from Statistics Sweden. It is saved as a comma-delimited file without heading, 00000031.csv, &lt;a href=&#34;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&#34; class=&#34;uri&#34;&gt;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The table: Average monthly pay (total pay), non-manual workers private sector (SLP), SEK by occupational group (SSYK), age, sex and year. Year 2014 - 2018&lt;/p&gt;
&lt;p&gt;The average age within each age group is used as a numeric value for graphical presentation and the linear model.&lt;/p&gt;
&lt;p&gt;As the salary increases exponentially each year, I have used the logarithm for years in my model.&lt;/p&gt;
&lt;p&gt;As a proxy for experience years since graduation can be used. I will simplify by using age as a proxy for experience. I will use a B-spline function to approximate the increase in salaries over age. Spline function is used instead of a polynomial to avoid oscillation.&lt;/p&gt;
&lt;p&gt;We expect that both years and age are important factors on the salary. As a null hypothesis, we assume that years and age is not related to the salary and examine if we can reject this hypothesis with the data from Statistics Sweden.&lt;/p&gt;
&lt;p&gt;Every year the annual salary negotiation will increase the salaries. As age increases, we acquire more skill at work.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb &amp;lt;- readfile(&amp;quot;00000031.csv&amp;quot;) %&amp;gt;% 
  rowwise() %&amp;gt;% 
  mutate(age_l = unlist(lapply(strsplit(substr(age, 1, 5), &amp;quot;-&amp;quot;), strtoi))[1]) %&amp;gt;%
  rowwise() %&amp;gt;% 
  mutate(age_h = unlist(lapply(strsplit(substr(age, 1, 5), &amp;quot;-&amp;quot;), strtoi))[2]) %&amp;gt;%
  mutate(age_n = (age_l + age_h) / 2) 
   
tb %&amp;gt;%
  ggplot () +  
    geom_point (mapping = aes(x = year_n,y = salary, colour = age, shape=sex)) + 
  labs(
    x = &amp;quot;Year&amp;quot;,
    y = &amp;quot;Salary (SEK/month)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-2&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-2-1.png&#34; alt=&#34;SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;    
model &amp;lt;- lm (log(salary) ~ year_n + sex + bs(age_n, knots = c(30, 40, 50, 60)), data = tb)

tb &amp;lt;- bind_cols(tb, as_tibble(exp(predict(model, tb, interval = &amp;quot;confidence&amp;quot;))))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;From the summary table of the linear model, we can see that the wages have increased by 1,91 % +/- 0,35 % per year with 95 % confidence, holding age as constant. The R-value from the Anova table for years is 120, sufficient for rejecting the null hypothesis that years has no effect on the salary. Holding year as constant, the p values for age are small (&amp;lt; 2e-16) and the R-value from the Anova table value for age is 703, sufficient for rejecting the null hypothesis that experience has no effect on the salary. The adjusted R-squared value is 0,984 implying a good fit of the model.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb %&amp;gt;%
  ggplot () +  
    geom_point (mapping = aes(x = year_n,y = fit, colour = age, shape=sex)) + 
  labs(
    x = &amp;quot;Year&amp;quot;,
    y = &amp;quot;Salary (SEK/month)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-3&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-3-1.png&#34; alt=&#34;Model fit, SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Model fit, SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;    
summary(model) %&amp;gt;%  
  tidy() %&amp;gt;%
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Summary from linear model fit&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;Summary from linear model fit&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-28.1818464&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.5078741&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-8.0338820&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;year_n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0190896&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0017400&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.9709680&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sexwomen&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0338703&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0050397&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.7207107&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0136922&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0224921&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6087566&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5443286&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2417694&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0207156&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.6708804&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4589440&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0172130&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26.6625840&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4963401&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0176805&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.0727805&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5045782&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0195688&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25.7848966&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4878569&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0169888&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.7164274&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4850548&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0143718&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33.7504146&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
summary(model)$r.squared   
## [1] 0.9839054
  
Anova(model, type=2) %&amp;gt;% 
  tidy() %&amp;gt;% 
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Anova report from linear model fit&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;Anova report from linear model fit&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sumsq&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;df&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;year_n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0687831&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;120.36214&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sex&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0258120&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45.16795&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.8136569&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;703.36608&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Residuals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0480033&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Let’s have a look at the spline function from the regression model. I use the package SplineUtils to extract the polynomial train from the model coefficients.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;myspline &amp;lt;- RegBsplineAsPiecePoly(model, &amp;quot;bs(age_n, knots = c(30, 40, 50, 60))&amp;quot;)

tibble(age_n = 21:65) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n,y = predict(myspline, age_n))) +
  labs(
    x = &amp;quot;Age&amp;quot;,
    y = &amp;quot;Salary&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-4&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-4-1.png&#34; alt=&#34;Model fit, SSYK 214, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Model fit, SSYK 214, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The derivative of the spline function for age is equal to the annual salary raise that comes from experience. I also add the salary raise that comes from the annual salary negotiation resulting in the total salary increase distributed over age.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summod &amp;lt;- tidy(summary (model))

myfun &amp;lt;- function(x){
  return (predict(myspline, x, deriv = 1) + summod$estimate[2])
}

tibble(age_n = 21:65) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n,y = myfun(age_n))) +
  labs(
    x = &amp;quot;Age&amp;quot;,
    y = &amp;quot;Salary raise (%)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-5&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-5-1.png&#34; alt=&#34;Model fit, SSYK 214, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Model fit, SSYK 214, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Now. let´s perform some diagnostics on the model. First, a look at the residuals for the model shows no apparent problem.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
plot(model, which = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-6&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-6-1.png&#34; alt=&#34;Residuals vs Fitted of model fit&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Residuals vs Fitted of model fit
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The Normal Q-Q shows some possible outliers.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
plot(model, which = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-7&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-7-1.png&#34; alt=&#34;Normal Q-Q&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 6: Normal Q-Q
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Again, the Standardised residuals show some possible outliers.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
plot(model, which = 3)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-8&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-8-1.png&#34; alt=&#34;Scale-Location&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 7: Scale-Location
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The outliers are also found in the Leverage plot.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
plot(model, which = 5)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-9&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-9-1.png&#34; alt=&#34;Residuals vs Leverage&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 8: Residuals vs Leverage
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The outliers 38, 56 and 75 are small groups with larger variance at either end of the age spectrum. Record 72 are women age 55-59.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb[38,]$age
## [1] &amp;quot;18-24 years&amp;quot;
tb[56,]$age
## [1] &amp;quot;65-66 years&amp;quot;
tb[75,]$age
## [1] &amp;quot;65-66 years&amp;quot;

tb[72,]
## Source: local data frame [1 x 12]
## Groups: &amp;lt;by row&amp;gt;
## 
## # A tibble: 1 x 12
##   `occuptional  (~ age   sex   year  salary year_n age_l age_h age_n    fit
##   &amp;lt;chr&amp;gt;            &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;  &amp;lt;dbl&amp;gt;  &amp;lt;dbl&amp;gt; &amp;lt;int&amp;gt; &amp;lt;int&amp;gt; &amp;lt;dbl&amp;gt;  &amp;lt;dbl&amp;gt;
## 1 214 Engineering~ 55-5~ women 2017   45000   2017    55    59    57 48433.
## # ... with 2 more variables: lwr &amp;lt;dbl&amp;gt;, upr &amp;lt;dbl&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Wage statistics&lt;/p&gt;
&lt;p&gt;The Mediation Institute is responsible for Sweden’s official salary statistics. This applies to three types of statistics: cyclical wage statistics, wage structure statistics and statistics supplied to the European statistical body Eurostat, &lt;a href=&#34;https://www.mi.se/other-languages/about-the-mediation-office-the-swedish-model-and-wage-statistics-in-english/&#34; class=&#34;uri&#34;&gt;https://www.mi.se/other-languages/about-the-mediation-office-the-swedish-model-and-wage-statistics-in-english/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The statistics are collected and processed by Statistics Sweden. It is reported both on Statistics Sweden’s website and the Mediation Institute’s website.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.r-bloggers.com/&#34; class=&#34;uri&#34;&gt;https://www.r-bloggers.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://rweekly.org&#34; class=&#34;uri&#34;&gt;https://rweekly.org&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Last edited: 2019-12-10&lt;/p&gt;
`</description>
    </item>
    
  </channel>
</rss>