<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>R on R Analystatistics Sweden</title>
    <link>/categories/r/</link>
    <description>Recent content in R on R Analystatistics Sweden</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 21 Dec 2019 00:00:00 +0000</lastBuildDate>
    
        <atom:link href="/categories/r/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>The significance of education on the salary in Sweden, a comparison between different occupational groups</title>
      <link>/2019/12/21/the-significance-of-education-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups/</link>
      <pubDate>Sat, 21 Dec 2019 00:00:00 +0000</pubDate>
      
      <guid>/2019/12/21/the-significance-of-education-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups/</guid>
      <description>`


&lt;p&gt;In my last post, I found that education has a significant impact on the salary of engineers. Is the significance of education on wages unique to engineers or are there similar correlations in other occupational groups?&lt;/p&gt;
&lt;p&gt;I will use the same model in principal as in my previous post to calculate the significance of education. I will not use sex as an explanatory variable since there are occupational groups that do not have enough data for both genders. Searching through the different occupational groups I will fit education with a polynomial of degree one. I am interested in occupational groups where a longer education also results in higher salaries. Because of that, I will use the numerical approximation from my last post instead of using the categorical predictor. A polynomial of higher degree than one would result in a better fit but the problem with oscillation and overfitting made me settle for degree one. A straight line as a function also has the advantage that the average increase in salary for each education year is directly given from the model.&lt;/p&gt;
&lt;p&gt;There are still occupational groups with too little data for regression analysis. More than 30 posts are necessary to fit both education and year.&lt;/p&gt;
&lt;p&gt;The F-value from the Anova table is used as the single value to discriminate how much education and salary correlates. For exploratory analysis, the Anova value seems good enough.&lt;/p&gt;
&lt;p&gt;In the figure below I will also use the estimate for education to see how much the salaries are raised by education for the different occupational groups holding year as constant.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (tidyverse)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## -- Attaching packages ------------------------------------------- tidyverse 1.2.1 --&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## v ggplot2 3.2.0     v purrr   0.3.2
## v tibble  2.1.3     v dplyr   0.8.3
## v tidyr   0.8.3     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## -- Conflicts ---------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (broom)
library (car)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: carData&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;car&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:dplyr&amp;#39;:
## 
##     recode&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:purrr&amp;#39;:
## 
##     some&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (splines)
#install_github(&amp;quot;ZheyuanLi/SplinesUtils&amp;quot;)
library (SplinesUtils)

readfile &amp;lt;- function (file1){read_csv (file1, col_types = cols(), locale = readr::locale (encoding = &amp;quot;latin1&amp;quot;), na = c(&amp;quot;..&amp;quot;, &amp;quot;NA&amp;quot;)) %&amp;gt;%
  gather (starts_with(&amp;quot;19&amp;quot;), starts_with(&amp;quot;20&amp;quot;), key = &amp;quot;year&amp;quot;, value = salary) %&amp;gt;%
  drop_na() %&amp;gt;%
  mutate (year_n = parse_number (year))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The data table is downloaded from Statistics Sweden. It is saved as a comma-delimited file without heading, 000000CY.csv, &lt;a href=&#34;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&#34; class=&#34;uri&#34;&gt;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The table: Average basic salary, monthly salary and women´s salary as a percentage of men´s salary by sector, occupational group (SSYK 2012), sex and educational level (SUN). Year 2014 - 2018 Monthly salary All sectors&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb &amp;lt;- readfile(&amp;quot;000000CY.csv&amp;quot;)

numedulevel &amp;lt;- read.csv(&amp;quot;edulevel.csv&amp;quot;) 

numedulevel %&amp;gt;%
  knitr::kable(
  booktabs = TRUE,
  caption = &amp;#39;Initial approach, length of education&amp;#39;) &lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-2&#34;&gt;Table 1: &lt;/span&gt;Initial approach, length of education&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;level.of.education&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;eduyears&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education 3 years (ISCED97 3A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;post-secondary education, less than 3 years (ISCED97 4+5B)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;post-secondary education 3 years or more (ISCED97 5A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tbnum &amp;lt;- tb %&amp;gt;% 
  right_join(numedulevel, by = c(&amp;quot;level of education&amp;quot; = &amp;quot;level.of.education&amp;quot;)) %&amp;gt;%
  filter(!is.na(eduyears))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Column `level of education`/`level.of.education` joining character
## vector and factor, coercing into character vector&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary_table = vector()
anova_table = vector()

for (i in unique(tbnum$`occuptional  (SSYK 2012)`)){
  temp &amp;lt;- filter(tbnum, `occuptional  (SSYK 2012)` == i)
  if (dim(temp)[1] &amp;gt; 30){
    model &amp;lt;- lm (log(salary) ~ year_n + eduyears, data = temp)
    summary_table &amp;lt;- rbind (summary_table, mutate (tidy (summary (model)), ssyk = i))
    anova_table &amp;lt;- rbind (anova_table, mutate (tidy (Anova (model, type = 2)), ssyk = i))
  }
}

merge(summary_table, anova_table, by = &amp;quot;ssyk&amp;quot;, all = TRUE) %&amp;gt;%
  filter (term.y == &amp;quot;eduyears&amp;quot;) %&amp;gt;%
  filter (term.x == &amp;quot;eduyears&amp;quot;) %&amp;gt;%
  mutate (estimate = (exp(estimate) - 1) * 100) %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = estimate, y = statistic.y)) +
    labs(
      x = &amp;quot;Increase in salaries (% / year of education)&amp;quot;,
      y = &amp;quot;F-value for education&amp;quot;
    ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-2&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-21-the-significance-of-education-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-2-1.png&#34; alt=&#34;The significance of education on the salary in Sweden, a comparison between different occupational groups, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: The significance of education on the salary in Sweden, a comparison between different occupational groups, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The table with all occupational groups sorted by Increase in salary in descending order.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;merge(summary_table, anova_table, by = &amp;quot;ssyk&amp;quot;, all = TRUE) %&amp;gt;%
  filter (term.y == &amp;quot;eduyears&amp;quot;) %&amp;gt;%
  filter (term.x == &amp;quot;eduyears&amp;quot;) %&amp;gt;%
  select (ssyk, estimate, statistic.y) %&amp;gt;%
  mutate (estimate = (exp(estimate) - 1) * 100) %&amp;gt;%
  rename (`F-value for education` = statistic.y) %&amp;gt;%
  rename (`Increase in salary` = estimate) %&amp;gt;%
  arrange (desc (`Increase in salary`)) %&amp;gt;%
  knitr::kable(
    booktabs = TRUE,
    caption = &amp;#39;Correlation for F-value (education) and the increase in salaries for each year of education&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 2: &lt;/span&gt;Correlation for F-value (education) and the increase in salaries for each year of education&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;ssyk&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Increase in salary&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;F-value for education&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;151 Health care managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.3222562&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;615.8861538&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;221 Medical doctors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.2650113&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;70.5835974&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;121 Finance managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.9172689&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;32.7350353&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;261 Legal professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.7834120&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48.1004817&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;122 Human resource managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.0394770&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;103.8231602&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;161 Financial and insurance managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.6603822&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.2527280&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;231 University and higher education teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.5276294&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;141.4796497&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;132 Supply, logistics and transport managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.6969576&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;87.6384397&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;137 Production managers in manufacturing&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.5378753&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;65.2842719&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;123 Administration and planning managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.2977859&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;129.4982036&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;136 Production managers in construction and mining&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.2192630&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57.8361291&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;129 Administration and service managers not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.6522431&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;74.9238199&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;131 Information and communications technology service managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.1937185&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;95.3092758&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;159 Other social services managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.1920288&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;355.8557670&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;134 Architectural and engineering managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.6458339&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;186.5137309&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;262 Museum curators and librarians and related professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.4638502&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;294.6004878&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;332 Insurance advisers, sales and purchasing agents&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.2505985&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;57.1999444&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;179 Other services managers not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.0931013&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;44.9824826&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;235 Teaching professionals not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.9957394&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;189.3385229&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;311 Physical and engineering science technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.9729301&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;134.6441603&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;234 Primary- and pre-school teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.8498852&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;140.3499938&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;233 Secondary education teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.7146273&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;167.3564935&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;125 Sales and marketing managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.6489071&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.5675213&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;241 Accountants, financial analysts and fund managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.3820710&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;49.5445027&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;242 Organisation analysts, policy administrators and human resource specialists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.1833018&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;94.6038730&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;213 Biologists, pharmacologists and specialists in agriculture and forestry&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.9242020&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93.6360138&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;321 Medical and pharmaceutical technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.7274994&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;130.1793959&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;133 Research and development managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.5377568&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.8355719&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;173 Retail and wholesale trade managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.4736675&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.9078862&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;335 Tax and related government associate professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.3658837&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41.8703194&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;214 Engineering professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.3546977&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;140.9367261&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;243 Marketing and public relations professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.3458276&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31.1353096&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;232 Vocational education teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.3303514&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27.2589020&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;334 Administrative and specialized secretaries&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.2765069&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.8078772&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;342 Athletes, fitness instructors and recreational workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.1279403&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.0465329&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;266 Social work and counselling professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.0818202&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;46.6894573&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;331 Financial and accounting associate professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.0726916&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.1402279&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;411 Office assistants and other secretaries&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.0115047&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60.8893100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;523 Cashiers and related clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.8137124&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.9599411&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;524 Event seller and telemarketers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.7261688&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13.0208742&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;251 ICT architects, systems analysts and test managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.5958484&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81.4664709&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;819 Process control technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.4963794&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40.1366829&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;962 Newspaper distributors, janitors and other service workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.3940863&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38.9982657&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;812 Metal processing and finishing plant operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.3878292&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12.9570916&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;432 Stores and transport clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.2376483&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.6773646&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;341 Social work and religious associate professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.1195539&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60.5012820&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;531 Child care workers and teachers aides&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0815506&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.6066709&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;264 Authors, journalists and linguists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0636388&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.4839869&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;333 Business services agents&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0019699&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.5614940&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;522 Shop staff&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9835325&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.4858527&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;351 ICT operations and user support technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9821077&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.4180769&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;441 Library and filing clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9770931&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.5562894&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;941 Fast-food workers, food preparation assistants&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8675015&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.3917476&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;611 Market gardeners and crop growers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8014313&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.0302572&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;817 Wood processing and papermaking plant operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.7291227&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.4060017&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;217 Designers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.7088900&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.8475401&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;831 Train operators and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5548934&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.3520151&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;932 Manufacturing labourers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5533498&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.2142587&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;343 Photographers, interior decorators and entertainers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5498463&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6786136&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;513 Waiters and bartenders&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5489340&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.0997794&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;312 Construction and manufacturing supervisors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5475032&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.3980603&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;534 Attendants, personal assistants and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5264678&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.8067668&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;515 Building caretakers and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5221112&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.8499176&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;815 Machine operators, textile, fur and leather products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4691193&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.1375421&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;422 Client information clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3886323&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.7115048&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;533 Health care assistants&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3239149&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.1630503&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;818 Other stationary plant and machine operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2957261&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0364217&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;512 Cooks and cold-buffet managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2548134&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9265992&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;711 Carpenters, bricklayers and construction workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2417011&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1572365&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;218 Specialists within environmental and health protection&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2397413&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4222318&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;961 Recycling collectors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1921605&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.8568597&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;541 Other surveillance and security workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1812197&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4153472&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;511 Cabin crew, guides and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1658380&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2150479&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;723 Machinery mechanics and fitters&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1410149&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2170183&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;821 Assemblers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0644892&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0858323&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;813 Machine operators, chemical and pharmaceutical products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0326476&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0217158&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;833 Heavy truck and bus drivers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0309875&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0482259&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;816 Machine operators, food and related products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0069780&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0017000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;532 Personal care workers in health services&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0383003&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1216850&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;352 Broadcasting and audio-visual technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0705932&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0171995&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;814 Machine operators, rubber, plastic and paper products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1428982&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2504506&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;722 Blacksmiths, toolmakers and related trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1569686&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4841203&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;732 Printing trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.3543764&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5477171&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;911 Cleaners and helpers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.3859718&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.5299051&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;834 Mobile plant operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.3979938&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.1952942&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;216 Architects and surveyors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.6970606&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.2794827&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;516 Other service related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.7106422&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.0123452&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;265 Creative and performing artists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.4326841&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.0250927&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Let’s check what we have found.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tbnum %&amp;gt;%
  filter(`occuptional  (SSYK 2012)` == &amp;quot;151 Health care managers&amp;quot;)

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = eduyears)) +
    facet_grid(. ~ sex) +   
    labs(
      x = &amp;quot;Year&amp;quot;,
      y = &amp;quot;Salary (SEK/month)&amp;quot;
    ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-4&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-21-the-significance-of-education-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-4-1.png&#34; alt=&#34;Highest increase in salary, 151 Health care managers&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Highest increase in salary, 151 Health care managers
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;modelcont &amp;lt;- lm (log(salary) ~ year_n + bs(eduyears, degree = 1), data = temp)

contspline &amp;lt;- RegBsplineAsPiecePoly(modelcont, &amp;quot;bs(eduyears, degree = 1)&amp;quot;)

tibble(eduyears = seq(11, 19, by=0.1)) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = eduyears,y = predict(contspline, eduyears))) +
  labs(
    x = &amp;quot;Years of education&amp;quot;,
    y = &amp;quot;Salary&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-5&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-21-the-significance-of-education-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-5-1.png&#34; alt=&#34;Model fit, Health care managers, Correlation between education and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Model fit, Health care managers, Correlation between education and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tibble(eduyears = seq(11, 19, by=0.1)) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = eduyears,y = (exp(predict(contspline, eduyears, deriv = 1)) - 1) * 100)) +
  labs(
    x = &amp;quot;Years of education&amp;quot;,
    y = &amp;quot;Salary difference (%)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-6&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-21-the-significance-of-education-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-6-1.png&#34; alt=&#34;Model fit, Health care managers, The derivative for educaton&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Model fit, Health care managers, The derivative for educaton
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tbnum %&amp;gt;% 
  filter(`occuptional  (SSYK 2012)` == &amp;quot;265 Creative and performing artists&amp;quot;)

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = eduyears)) +
    facet_grid(. ~ sex) +   
    labs(
      x = &amp;quot;Year&amp;quot;,
      y = &amp;quot;Salary (SEK/month)&amp;quot;
    ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-7&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-21-the-significance-of-education-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-7-1.png&#34; alt=&#34;Lowest increase in salary, 265 Creative and performing artists&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Lowest increase in salary, 265 Creative and performing artists
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;modelcont &amp;lt;- lm (log(salary) ~ year_n + bs(eduyears, degree = 1), data = temp)

contspline &amp;lt;- RegBsplineAsPiecePoly(modelcont, &amp;quot;bs(eduyears, degree = 1)&amp;quot;)

tibble(eduyears = seq(11, 15, by=0.1)) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = eduyears,y = predict(contspline, eduyears))) +
  labs(
    x = &amp;quot;Years of education&amp;quot;,
    y = &amp;quot;Salary&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-8&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-21-the-significance-of-education-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-8-1.png&#34; alt=&#34;Model fit, Creative and performing artists, Correlation between education and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 6: Model fit, Creative and performing artists, Correlation between education and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tibble(eduyears = seq(11, 15, by=0.1)) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = eduyears,y = (exp(predict(contspline, eduyears, deriv = 1)) - 1) * 100)) +
  labs(
    x = &amp;quot;Years of education&amp;quot;,
    y = &amp;quot;Salary difference (%)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-9&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-21-the-significance-of-education-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-9-1.png&#34; alt=&#34;Model fit, Creative and performing artists, The derivative for education&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 7: Model fit, Creative and performing artists, The derivative for education
&lt;/p&gt;
&lt;/div&gt;
`</description>
    </item>
    
    <item>
      <title>The significance of education on the salary of engineers in Sweden</title>
      <link>/2019/12/15/the-significance-of-education-on-the-salary-of-engineers-in-sweden/</link>
      <pubDate>Sun, 15 Dec 2019 00:00:00 +0000</pubDate>
      
      <guid>/2019/12/15/the-significance-of-education-on-the-salary-of-engineers-in-sweden/</guid>
      <description>`


&lt;p&gt;In my last posts, I analysed the significance of experience for different occupational groups. In this post, I will turn the interest towards education. I will again start with engineers and see if I can expand my analysis to all occupational groups.&lt;/p&gt;
&lt;p&gt;First, define libraries and functions.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (tidyverse) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## -- Attaching packages ------------------------------------------- tidyverse 1.2.1 --&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## v ggplot2 3.2.0     v purrr   0.3.2
## v tibble  2.1.3     v dplyr   0.8.3
## v tidyr   0.8.3     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## -- Conflicts ---------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (broom) 
library (car)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Loading required package: carData&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
## Attaching package: &amp;#39;car&amp;#39;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:dplyr&amp;#39;:
## 
##     recode&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## The following object is masked from &amp;#39;package:purrr&amp;#39;:
## 
##     some&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (splines)
#install_github(&amp;quot;ZheyuanLi/SplinesUtils&amp;quot;)
library(SplinesUtils)

readfile &amp;lt;- function (file1){  
  read_csv (file1, col_types = cols(), locale = readr::locale (encoding = &amp;quot;latin1&amp;quot;), na = c(&amp;quot;..&amp;quot;, &amp;quot;NA&amp;quot;)) %&amp;gt;%  
    gather (starts_with(&amp;quot;19&amp;quot;), starts_with(&amp;quot;20&amp;quot;), key = &amp;quot;year&amp;quot;, value = salary) %&amp;gt;%  
    drop_na() %&amp;gt;%  
    mutate (year_n = parse_number (year))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The data table is downloaded from Statistics Sweden. It is saved as a comma-delimited file without heading, 000000CY.csv, &lt;a href=&#34;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&#34; class=&#34;uri&#34;&gt;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The table: Average basic salary, monthly salary and women´s salary as a percentage of men´s salary by sector, occupational group (SSYK 2012), sex and educational level (SUN). Year 2014 - 2018 Monthly salary All sectors&lt;/p&gt;
&lt;p&gt;We expect that education is an important factor in salaries. As a null hypothesis, we assume that education is not related to the salary and examine if we can reject this hypothesis with the data from Statistics Sweden.&lt;/p&gt;
&lt;p&gt;The column &lt;code&gt;level of education&lt;/code&gt; is renamed because TukeyHSD doesn’t handle variable names within quotes.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb &amp;lt;- readfile(&amp;quot;000000CY.csv&amp;quot;) %&amp;gt;% 
  filter(`occuptional  (SSYK 2012)` == &amp;quot;214 Engineering professionals&amp;quot;) %&amp;gt;%       
  mutate(edulevel = `level of education`)

tb %&amp;gt;%
  ggplot () +  
    geom_point (mapping = aes(x = year_n,y = salary, colour = `level of education`, shape=sex)) + 
  labs(
    x = &amp;quot;Year&amp;quot;,
    y = &amp;quot;Salary (SEK/month)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-2&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-2-1.png&#34; alt=&#34;SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;- lm (log(salary) ~ year_n + sex + edulevel, data = tb)

tb &amp;lt;- bind_cols(tb, as_tibble(exp(predict(model, tb, interval = &amp;quot;confidence&amp;quot;))))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The F-value from the Anova table for years is 40 (Pr(&amp;gt;F) &amp;lt; 2.2e-16), sufficient for rejecting the null hypothesis that education has no effect on the salary holding year as constant. The adjusted R-squared value is 0,833 implying a good fit of the model.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb %&amp;gt;%
  ggplot () +  
    geom_point (mapping = aes(x = year_n,y = fit, colour = edulevel, shape = sex)) + 
  labs(
    x = &amp;quot;Year&amp;quot;,
    y = &amp;quot;Salary (SEK/month)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-3&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-3-1.png&#34; alt=&#34;Model fit, SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Model fit, SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(model) %&amp;gt;%  
  tidy() %&amp;gt;%
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Summary from linear model fit&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;Summary from linear model fit&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-27.3895893&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.6236266&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-4.1351349&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001120&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;year_n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0189082&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0032856&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;5.7549246&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000003&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sexwomen&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0837412&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0092178&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-9.0847619&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevelpost-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1114561&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0171029&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.5167907&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevelpost-secondary education 3 years or more (ISCED97 5A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0010205&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0171029&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0596699&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.9526168&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevelpost-secondary education, less than 3 years (ISCED97 4+5B)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0332012&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0171029&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-1.9412595&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0569278&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevelprimary and secondary education 9-10 years (ISCED97 2)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1089810&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0175947&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.1939725&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevelupper secondary education 3 years (ISCED97 3A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0784305&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0171029&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-4.5857936&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000235&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevelupper secondary education, 2 years or less (ISCED97 3C)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1040503&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0171029&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.0837761&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000001&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(model)$adj.r.squared  &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.8327314&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;Anova(model, type = 2) %&amp;gt;% 
  tidy() %&amp;gt;% 
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Anova report from linear model fit&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;Anova report from linear model fit&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sumsq&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;df&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;year_n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0484384&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33.11916&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3e-07&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sex&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1207084&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;82.53290&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0e+00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3529225&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40.21774&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0e+00&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Residuals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0877529&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;60&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;How much do the different levels of education affect the salary? We can calculate the differences between the levels with Tukey’s honest significant difference. All significant level differences are shown in the table below.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tukeytable &amp;lt;- TukeyHSD(aov(log(salary) ~ sex + edulevel, data = tb)) %&amp;gt;%
  tidy() %&amp;gt;%
  mutate(percdiff = (1 / exp(estimate) - 1) * 100)

tukeytable  %&amp;gt;% 
  filter(adj.p.value &amp;lt; 0.05) %&amp;gt;%
  arrange(estimate) %&amp;gt;%  
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Tukey HSD 95 % confidence intervals for the pairwise significant differences&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-4&#34;&gt;Table 2: &lt;/span&gt;Tukey HSD 95 % confidence intervals for the pairwise significant differences&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;comparison&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;conf.low&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;conf.high&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;adj.p.value&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;percdiff&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2160450&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2822364&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1498535&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.115819&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2155065&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2799325&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1510804&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.049001&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education 3 years (ISCED97 3A)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1898866&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2543126&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1254606&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.911247&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;post-secondary education, less than 3 years (ISCED97 4+5B)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1446573&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2090834&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0802313&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000001&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.564352&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;post-secondary education 3 years or more (ISCED97 5A)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1104356&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1748616&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0460096&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.676444&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)-post-secondary education 3 years or more (ISCED97 5A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1056094&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1718008&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0394179&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001649&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.138763&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)-post-secondary education 3 years or more (ISCED97 5A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1050709&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1694969&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0406448&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001119&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.078932&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)-no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1045888&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1707803&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0383974&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001950&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.025400&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)-no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1040503&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1684764&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0396243&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001331&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.965630&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sex&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;women-men&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0803151&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1030666&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0575637&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.362851&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education 3 years (ISCED97 3A)-post-secondary education 3 years or more (ISCED97 5A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0794510&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1438770&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0150250&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0066749&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.269249&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education 3 years (ISCED97 3A)-no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0784305&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1428565&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0140044&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0077374&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.158814&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)-post-secondary education, less than 3 years (ISCED97 4+5B)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0713876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1375791&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0051962&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0264560&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.399745&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)-post-secondary education, less than 3 years (ISCED97 4+5B)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0708491&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1352751&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0064231&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0221087&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.341926&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;post-graduate education (ISCED97 6)-no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1114561&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0470301&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1758822&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000370&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-10.546938&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;We can conclude from the summary table that there is a positive correlation between longer education and higher salaries.&lt;/p&gt;
&lt;p&gt;From the table of Tukey’s honest significant difference, we can see the difference in salaries between the different education lengths. Note that the estimates are negative due to the log transformation, the untransformed differences are in the column percdiff.&lt;/p&gt;
&lt;p&gt;Can we approximate how much the salaries increase by one year of education by assigning a numeric value to the factors in the table?&lt;/p&gt;
&lt;p&gt;As a first approach, I will use the data in the following table.&lt;/p&gt;
&lt;p&gt;I will use a B-spline function to approximate the increase in salaries over age. The rows for “no information about the level of educational attainment” is removed from the table from Statistics Sweden.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;numedulevel &amp;lt;- read.csv(&amp;quot;edulevel.csv&amp;quot;) 

numedulevel %&amp;gt;%
  knitr::kable(
  booktabs = TRUE,
  caption = &amp;#39;Initial approach, length of education&amp;#39;) &lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-5&#34;&gt;Table 3: &lt;/span&gt;Initial approach, length of education&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;level.of.education&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;eduyears&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education 3 years (ISCED97 3A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;post-secondary education, less than 3 years (ISCED97 4+5B)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;post-secondary education 3 years or more (ISCED97 5A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tbnum &amp;lt;- tb %&amp;gt;% 
    right_join(numedulevel, by = c(&amp;quot;level of education&amp;quot; = &amp;quot;level.of.education&amp;quot;)) %&amp;gt;%
  filter(!is.na(eduyears))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Column `level of education`/`level.of.education` joining character
## vector and factor, coercing into character vector&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;modelcont &amp;lt;- lm(log(salary) ~ bs(eduyears, knots = c(14)) + year_n + sex, data = tbnum)

tbnum &amp;lt;- bind_cols(tbnum, as_tibble(exp(predict(modelcont, tbnum, interval = &amp;quot;confidence&amp;quot;))))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The F-value from the Anova table for years is 146 and the adjusted R-squared value is 0,932 implying a good fit of the model. Both the F-value and the adjusted R-squared increased from then using the categorical predictors. (Removing the rows with “no information about level of educational attainment” improves the adjusted R-squared for the model with categorical predictors to 0.931.)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tbnum %&amp;gt;%
  ggplot () +  
    geom_point (mapping = aes(x = year_n,y = fit1, colour = eduyears, shape = sex)) + 
  labs(
    x = &amp;quot;Year&amp;quot;,
    y = &amp;quot;Salary (SEK/month)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-6&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-6-1.png&#34; alt=&#34;Model fit, SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Model fit, SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(modelcont) %&amp;gt;%  
  tidy() %&amp;gt;%
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Summary from linear model fit&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-6&#34;&gt;Table 4: &lt;/span&gt;Summary from linear model fit&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-35.1115742&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.5503183&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-7.7162898&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(eduyears, knots = c(14))1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0113708&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0237866&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.4780331&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6346302&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(eduyears, knots = c(14))2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0719453&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0468930&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.5342429&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1310323&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(eduyears, knots = c(14))3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1850177&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0567742&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.2588347&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0019749&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(eduyears, knots = c(14))4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2212179&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0111456&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.8480339&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;year_n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0226818&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0022569&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.0500379&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sexwomen&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0743275&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0063230&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-11.7551579&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summary(modelcont)$adj.r.squared  &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 0.9316461&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;Anova(modelcont, type = 2) %&amp;gt;% 
  tidy() %&amp;gt;% 
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Anova report from linear model fit&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-6&#34;&gt;Table 4: &lt;/span&gt;Anova report from linear model fit&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sumsq&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;df&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(eduyears, knots = c(14))&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.3429901&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;145.7866&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;year_n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0594072&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;101.0033&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sex&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0812757&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;138.1837&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Residuals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0305849&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;52&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;What does the continous function from the model look like?&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;contspline &amp;lt;- RegBsplineAsPiecePoly(modelcont, &amp;quot;bs(eduyears, knots = c(14))&amp;quot;)

tibble(eduyears = 9:19) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = eduyears,y = predict(contspline, eduyears))) +
  labs(
    x = &amp;quot;Years of education&amp;quot;,
    y = &amp;quot;Salary&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-7&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-7-1.png&#34; alt=&#34;Model fit, SSYK 214, Correlation between education and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Model fit, SSYK 214, Correlation between education and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;And it’s derivative.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tibble(eduyears = 9:19) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = eduyears,y = (exp(predict(contspline, eduyears, deriv = 1)) - 1) * 100)) +
  labs(
    x = &amp;quot;Years of education&amp;quot;,
    y = &amp;quot;Salary difference (%)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-8&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-8-1.png&#34; alt=&#34;Model fit, SSYK 214, The derivative for education&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Model fit, SSYK 214, The derivative for education
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Comparison between the categorical and the continuous predictor. Column withinconf states if the estimate from the numerical model is within the 95 % confidence interval from the Tukey’s honest significant difference table. All estimates from the model with the continuous predictor are within the 95 % confidence intervals from the Tukey HSD table.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tukeytable &amp;lt;- tukeytable %&amp;gt;% 
  rowwise() %&amp;gt;% 
  mutate(comp_from = unlist(strsplit(comparison, &amp;quot;)-&amp;quot;))[1]) %&amp;gt;%
  rowwise() %&amp;gt;% 
  mutate(comp_to = unlist(strsplit(comparison, &amp;quot;)-&amp;quot;))[2]) %&amp;gt;%             mutate(comp_from = paste (comp_from, &amp;quot;)&amp;quot;, sep=&amp;quot;&amp;quot;)) %&amp;gt;%
  left_join(numedulevel, by = c(&amp;quot;comp_from&amp;quot; = &amp;quot;level.of.education&amp;quot;)) %&amp;gt;%
  left_join(numedulevel, by = c(&amp;quot;comp_to&amp;quot; = &amp;quot;level.of.education&amp;quot;)) %&amp;gt;%    mutate(numestimate = predict(contspline, eduyears.x) -           predict(contspline, eduyears.y)) %&amp;gt;% 
  mutate(withinconf = numestimate &amp;gt; conf.low &amp;amp;&amp;amp; numestimate &amp;lt; conf.high) %&amp;gt;% 
  mutate(percdiffcont = (1 / exp(predict(contspline, eduyears.x) - predict(contspline, eduyears.y)) - 1) * 100)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Column `comp_from`/`level.of.education` joining character vector and
## factor, coercing into character vector&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Column `comp_to`/`level.of.education` joining character vector and
## factor, coercing into character vector&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tukeytable %&amp;gt;% 
  select(term, comparison, estimate, adj.p.value, numestimate, withinconf, percdiff, percdiffcont) %&amp;gt;%
  filter(adj.p.value &amp;lt; 0.05) %&amp;gt;%
  arrange(estimate) %&amp;gt;%
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Comparison between categorical and continous predictor&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-9&#34;&gt;Table 5: &lt;/span&gt;Comparison between categorical and continous predictor&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;comparison&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;adj.p.value&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;numestimate&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;withinconf&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;percdiff&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;percdiffcont&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2160450&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2212179&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.115819&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.7595300&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2155065&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.2123268&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.049001&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.6551904&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education 3 years (ISCED97 3A)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1898866&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1942616&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.911247&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.4413939&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;post-secondary education, less than 3 years (ISCED97 4+5B)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1446573&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000001&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1418336&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.564352&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.2384840&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;post-secondary education 3 years or more (ISCED97 5A)-post-graduate education (ISCED97 6)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1104356&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1117048&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.676444&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.8182726&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)-post-secondary education 3 years or more (ISCED97 5A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1056094&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001649&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1095131&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.138763&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.5734729&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)-post-secondary education 3 years or more (ISCED97 5A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1050709&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001119&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1006220&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.078932&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.5858529&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)-no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1045888&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001950&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.025400&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)-no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.1040503&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0001331&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0088912&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.965630&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.8851746&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sex&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;women-men&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0803151&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.362851&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education 3 years (ISCED97 3A)-post-secondary education 3 years or more (ISCED97 5A)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0794510&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0066749&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0825568&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.269249&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.6060365&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education 3 years (ISCED97 3A)-no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0784305&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0077374&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0269563&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.158814&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-2.6596254&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;primary and secondary education 9-10 years (ISCED97 2)-post-secondary education, less than 3 years (ISCED97 4+5B)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0713876&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0264560&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0793844&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.399745&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.2620369&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;upper secondary education, 2 years or less (ISCED97 3C)-post-secondary education, less than 3 years (ISCED97 4+5B)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0708491&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0221087&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0704932&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TRUE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.341926&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7.3037289&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;edulevel&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;post-graduate education (ISCED97 6)-no information about level of educational attainment&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.1114561&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000370&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2212179&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;FALSE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-10.546938&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-19.8458026&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Now. let´s perform some diagnostics on the models. First, a look at the residuals for the model shows no apparent problem. We can see that the outlier at row 55 has disappeared in the plots for the continuous model.&lt;/p&gt;
&lt;p&gt;Three out of four outliers when using categorical predictors were from the factor “no information about level of educational attainment”.&lt;/p&gt;
&lt;p&gt;For the continuous predictors there are two outliers in the factor “upper secondary education, 2 years or less (ISCED97 3C)” and two outliers in the factor “upper secondary education 3 years (ISCED97 3A)” indicating that the model could be improved.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb[20,]$edulevel&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;no information about level of educational attainment&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb[41,]$edulevel&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;no information about level of educational attainment&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb[55,]$edulevel&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;no information about level of educational attainment&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb[57,]$edulevel&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;upper secondary education, 2 years or less (ISCED97 3C)&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tbnum[12,]$edulevel&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;upper secondary education, 2 years or less (ISCED97 3C)&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tbnum[18,]$edulevel&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;upper secondary education, 2 years or less (ISCED97 3C)&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tbnum[25,]$edulevel&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;upper secondary education 3 years (ISCED97 3A)&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tbnum[29,]$edulevel&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;upper secondary education 3 years (ISCED97 3A)&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(model, which = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-111&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-11-1.png&#34; alt=&#34;Residuals vs Fitted of model fit&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 6: Residuals vs Fitted of model fit
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(modelcont, which = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-112&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-11-2.png&#34; alt=&#34;Residuals vs Fitted of model fit&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 7: Residuals vs Fitted of model fit
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The Normal Q-Q shows some possible outliers.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(model, which = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-121&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-12-1.png&#34; alt=&#34;Normal Q-Q&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 8: Normal Q-Q
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(modelcont, which = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-122&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-12-2.png&#34; alt=&#34;Normal Q-Q&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 9: Normal Q-Q
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Again, the Standardised residuals show some possible outliers.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(model, which = 3)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-131&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-13-1.png&#34; alt=&#34;Scale-Location&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 10: Scale-Location
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(modelcont, which = 3)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-132&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-13-2.png&#34; alt=&#34;Scale-Location&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 11: Scale-Location
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The outliers are also found in the Leverage plot.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(model, which = 5)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-141&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-14-1.png&#34; alt=&#34;Residuals vs Leverage&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 12: Residuals vs Leverage
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot(modelcont, which = 5)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-142&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-15-the-significance-of-education-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-14-2.png&#34; alt=&#34;Residuals vs Leverage&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 13: Residuals vs Leverage
&lt;/p&gt;
&lt;/div&gt;
`</description>
    </item>
    
    <item>
      <title>The significance of experience on the salary in Sweden, a comparison between different occupational groups</title>
      <link>/2019/12/02/the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups/</link>
      <pubDate>Mon, 02 Dec 2019 00:00:00 +0000</pubDate>
      
      <guid>/2019/12/02/the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups/</guid>
      <description>`


&lt;p&gt;In my last post, I found that experience has a significant impact on the salary of engineers. Is the significance of experience on wages unique to engineers or are there similar correlations in other occupational groups?&lt;/p&gt;
&lt;p&gt;I will use the same model in principal as in my previous post to calculate the significance of age. I will not use sex as an explanatory variable since there are occupational groups that do not have enough data for both genders. I will also use a polynomial of degree three since this provides a significant model fit for some occupational groups.&lt;/p&gt;
&lt;p&gt;There are still occupational groups with too little data for regression analysis. More than 30 posts are necessary to fit both age and year.&lt;/p&gt;
&lt;p&gt;The R-value from the Anova table is used as the single value to discriminate how much the age and salary correlates. For exploratory analysis, the Anova value seems good enough.&lt;/p&gt;
&lt;p&gt;In the figure below I will also use the estimate for the year to see how much the salaries are raised each year for the different occupational groups holding age as constant.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (tidyverse)
## -- Attaching packages -------------------------------------------- tidyverse 1.2.1 --
## v ggplot2 3.2.0     v purrr   0.3.2
## v tibble  2.1.3     v dplyr   0.8.3
## v tidyr   0.8.3     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0
## -- Conflicts ----------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
library (broom)
library (car)
## Loading required package: carData
## 
## Attaching package: &amp;#39;car&amp;#39;
## The following object is masked from &amp;#39;package:dplyr&amp;#39;:
## 
##     recode
## The following object is masked from &amp;#39;package:purrr&amp;#39;:
## 
##     some
library (polynom)

readfile &amp;lt;- function (file1){read_csv (file1, col_types = cols(), locale = readr::locale (encoding = &amp;quot;latin1&amp;quot;), na = c(&amp;quot;..&amp;quot;, &amp;quot;NA&amp;quot;)) %&amp;gt;%
  gather (starts_with(&amp;quot;19&amp;quot;), starts_with(&amp;quot;20&amp;quot;), key = &amp;quot;year&amp;quot;, value = salary) %&amp;gt;%
  drop_na() %&amp;gt;%
  mutate (year_n = parse_number (year))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The data table is downloaded from Statistics Sweden. It is saved as a comma-delimited file without heading, 000000D2.csv, &lt;a href=&#34;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&#34; class=&#34;uri&#34;&gt;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The table: Average basic salary, monthly salary and women´s salary as a percentage of men´s salary by sector, occupational group (SSYK 2012), sex and age. Year 2014 - 2018 Monthly salary All sectors&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb &amp;lt;- readfile(&amp;quot;000000D2.csv&amp;quot;) %&amp;gt;%
  rowwise() %&amp;gt;%
  mutate(age_l = unlist(lapply(strsplit(substr(age, 1, 5), &amp;quot;-&amp;quot;), strtoi))[1]) %&amp;gt;%
  rowwise() %&amp;gt;%
  mutate(age_h = unlist(lapply(strsplit(substr(age, 1, 5), &amp;quot;-&amp;quot;), strtoi))[2]) %&amp;gt;%
  mutate(age_n = (age_l + age_h) / 2)

summary_table = 0
anova_table = 0

for (i in unique(tb$`occuptional  (SSYK 2012)`)){
  temp &amp;lt;- filter(tb, `occuptional  (SSYK 2012)` == i)
  if (dim(temp)[1] &amp;gt; 30){
    model &amp;lt;-lm (log(salary) ~ year_n + poly(age_n, 3), data = temp)
    summary_table &amp;lt;- rbind (summary_table, mutate (tidy (summary (model)), ssyk = i))
    anova_table &amp;lt;- rbind (anova_table, mutate (tidy (Anova (model, type = 2)), ssyk = i))
  }
}

merge(summary_table, anova_table, by = &amp;quot;ssyk&amp;quot;, all = TRUE) %&amp;gt;%
  filter (term.y == &amp;quot;poly(age_n, 3)&amp;quot;) %&amp;gt;%
  filter (term.x == &amp;quot;year_n&amp;quot;) %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = estimate, y = statistic.y)) +
    labs(
      x = &amp;quot;Increase in salaries (% / year)&amp;quot;,
      y = &amp;quot;F-value for age&amp;quot;
    ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-2&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-2-1.png&#34; alt=&#34;The significance of experience on the salary in Sweden, a comparison between different occupational groups, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: The significance of experience on the salary in Sweden, a comparison between different occupational groups, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The table with all occupational groups sorted by F-value in descending order.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;merge(summary_table, anova_table, by = &amp;quot;ssyk&amp;quot;, all = TRUE) %&amp;gt;%
  filter (term.y == &amp;quot;poly(age_n, 3)&amp;quot;) %&amp;gt;%
  filter (term.x == &amp;quot;year_n&amp;quot;) %&amp;gt;%
  select (ssyk, estimate, statistic.y) %&amp;gt;%
  rename (`F-value for age` = statistic.y) %&amp;gt;%
  rename (`Increase in salary` = estimate) %&amp;gt;%
  arrange (desc (`F-value for age`)) %&amp;gt;%
  knitr::kable(
    booktabs = TRUE,
    caption = &amp;#39;Correlation for F-value (age) and the yearly increase in salaries with age held as constant&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;Correlation for F-value (age) and the yearly increase in salaries with age held as constant&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;ssyk&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;Increase in salary&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;F-value for age&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;234 Primary- and pre-school teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0345563&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1349.859088&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;233 Secondary education teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0294574&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;861.331070&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;532 Personal care workers in health services&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0285338&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;800.259659&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;336 Police officers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0284911&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;675.571576&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;223 Nursing professionals (cont.)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0303955&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;625.404523&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;214 Engineering professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0192393&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;612.414362&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;235 Teaching professionals not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0245885&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;578.686817&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;266 Social work and counselling professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0316617&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;551.888399&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;221 Medical doctors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0150176&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;449.792500&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;251 ICT architects, systems analysts and test managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0249600&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;415.590103&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;534 Attendants, personal assistants and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0191811&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;406.258604&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;231 University and higher education teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0254827&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;404.602202&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;222 Nursing professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0414071&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;371.107319&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;533 Health care assistants&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0205813&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;345.075594&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;531 Child care workers and teachers aides&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0219044&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;291.049608&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;351 ICT operations and user support technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0211211&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;271.091961&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;159 Other social services managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0251218&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;191.570380&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;211 Physicists and chemists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0207272&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;186.366824&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;321 Medical and pharmaceutical technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0288946&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;177.137635&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;152 Managers in social and curative care&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0387001&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;164.636802&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;243 Marketing and public relations professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0150173&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;154.310784&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;723 Machinery mechanics and fitters&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0204993&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;146.299981&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;125 Sales and marketing managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0187356&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;145.732333&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;141 Primary and secondary schools and adult education managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0346753&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;142.578762&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;341 Social work and religious associate professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0255830&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;137.073911&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;133 Research and development managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0137728&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;135.323107&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;153 Elderly care managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0331514&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;132.163025&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;242 Organisation analysts, policy administrators and human resource specialists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0223881&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;132.013557&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;332 Insurance advisers, sales and purchasing agents&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0176134&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;128.196288&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;218 Specialists within environmental and health protection&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0258110&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;120.206634&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;311 Physical and engineering science technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0213202&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;119.371812&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;422 Client information clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0175877&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;117.057208&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;411 Office assistants and other secretaries&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0250406&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;115.401389&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;264 Authors, journalists and linguists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0158766&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;107.667527&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;226 Dentists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0230213&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;99.061845&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;232 Vocational education teachers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0298647&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;93.534293&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;122 Human resource managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0365348&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86.595103&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;342 Athletes, fitness instructors and recreational workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0162825&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;86.085107&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;515 Building caretakers and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0188443&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;85.346469&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;123 Administration and planning managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0423650&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;81.886461&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;137 Production managers in manufacturing&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0267995&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;80.958767&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;227 Naprapaths, physiotherapists, occupational therapists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0212967&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;78.930141&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;132 Supply, logistics and transport managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0135557&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;78.186301&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;817 Wood processing and papermaking plant operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0289197&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75.983376&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;441 Library and filing clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0210449&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75.872685&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;131 Information and communications technology service managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0431537&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75.423080&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;343 Photographers, interior decorators and entertainers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0339142&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;75.132287&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;241 Accountants, financial analysts and fund managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0270620&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;71.204029&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;216 Architects and surveyors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0241267&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;68.945982&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;134 Architectural and engineering managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0236760&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;68.279874&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;228 Specialists in health care not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0272838&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;64.426085&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;213 Biologists, pharmacologists and specialists in agriculture and forestry&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0144849&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63.378555&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;831 Train operators and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0177987&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;55.404356&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;334 Administrative and specialized secretaries&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0292702&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;52.477105&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;335 Tax and related government associate professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0227003&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;49.850281&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;224 Psychologists and psychotherapists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0270655&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47.653074&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;511 Cabin crew, guides and related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0069736&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47.413185&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;812 Metal processing and finishing plant operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0176743&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47.395879&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;331 Financial and accounting associate professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0229113&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45.186053&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;261 Legal professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0292942&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;44.569161&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;819 Process control technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0232825&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.919550&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;333 Business services agents&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0263028&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;43.327180&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;961 Recycling collectors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0225031&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;42.772133&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;312 Construction and manufacturing supervisors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0322029&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41.767797&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;516 Other service related workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0202784&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;41.325733&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;262 Museum curators and librarians and related professionals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0228651&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;40.378111&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;265 Creative and performing artists&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0252235&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;39.119906&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;741 Electrical equipment installers and repairers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0221901&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;38.176541&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;524 Event seller and telemarketers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0203373&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36.349688&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;941 Fast-food workers, food preparation assistants&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0199578&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;35.998201&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;815 Machine operators, textile, fur and leather products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0128372&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33.582965&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;962 Newspaper distributors, janitors and other service workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0141958&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;32.540073&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;136 Production managers in construction and mining&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0264825&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;31.006282&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;834 Mobile plant operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0251599&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30.439935&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;816 Machine operators, food and related products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0198706&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.543569&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;129 Administration and service managers not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0171682&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;29.032377&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;212 Mathematicians, actuaries and statisticians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0240773&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.949679&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;352 Broadcasting and audio-visual technicians&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0067079&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.725776&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;513 Waiters and bartenders&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0214795&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.455515&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;813 Machine operators, chemical and pharmaceutical products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0254550&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26.563325&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;151 Health care managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0211530&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24.870942&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;611 Market gardeners and crop growers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0089573&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.602904&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;732 Printing trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0191704&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23.581610&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;432 Stores and transport clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0217702&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.969527&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;217 Designers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0252062&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22.823943&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;161 Financial and insurance managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0518758&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21.908728&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;711 Carpenters, bricklayers and construction workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0136555&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20.268520&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;541 Other surveillance and security workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0239438&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19.245270&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;179 Other services managers not elsewhere classified&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0272448&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17.108091&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;911 Cleaners and helpers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0176513&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16.284355&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;512 Cooks and cold-buffet managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0278549&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.787404&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;814 Machine operators, rubber, plastic and paper products&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0245275&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15.256042&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;267 Religious professionals and deacons&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0268407&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.266331&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;761 Butchers, bakers and food processors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0153660&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.168879&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;722 Blacksmiths, toolmakers and related trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0192713&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.890741&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;121 Finance managers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0276643&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.785317&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;752 Wood treaters, cabinet-makers and related trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0269102&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.779896&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;713 Painters, Lacquerers, Chimney-sweepers and related trades workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0259098&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.415854&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;932 Manufacturing labourers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0266336&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9.113769&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;522 Shop staff&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0267679&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8.247675&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;818 Other stationary plant and machine operators&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0237780&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.983074&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;344 Driving instructors and other instructors&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0286480&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;6.971261&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;523 Cashiers and related clerks&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0041737&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.970851&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;833 Heavy truck and bus drivers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0188392&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.786235&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;912 Washers, window cleaners and other cleaning workers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0382761&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4.701424&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;821 Assemblers&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0286219&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1.405402&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Let’s check what we have found.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tb %&amp;gt;%
  filter(`occuptional  (SSYK 2012)` == &amp;quot;234 Primary- and pre-school teachers&amp;quot;)
 
temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = age)) +
    facet_grid(. ~ sex) +   
    labs(
      x = &amp;quot;Year&amp;quot;,
      y = &amp;quot;Salary (SEK/month)&amp;quot;
    ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-4&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-4-1.png&#34; alt=&#34;Highest F-value, Primary- and pre-school teachers&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Highest F-value, Primary- and pre-school teachers
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;-lm (log(salary) ~ year_n + poly(age_n, 3, raw = T), data = temp)

summod &amp;lt;- tidy(summary (model))

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = age_n,y = age_n * summod$estimate[3] + summod$estimate[4] * age_n^2 + summod$estimate[5] * age_n^3)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-5&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-5-1.png&#34; alt=&#34;Model fit, Primary- and pre-school teachers, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Model fit, Primary- and pre-school teachers, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pdx &amp;lt;- deriv(as.polynomial(c(0, summod$estimate[3], summod$estimate[4], summod$estimate[5])))

temp %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n, y = summod$estimate[2] + pdx[1] + pdx[2] * age_n + pdx[3] * age_n^2)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary raise (%)&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-6&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-6-1.png&#34; alt=&#34;Model fit, Primary- and pre-school teachers, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Model fit, Primary- and pre-school teachers, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tb %&amp;gt;%
  filter(`occuptional  (SSYK 2012)` == &amp;quot;821 Assemblers&amp;quot;)

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = age)) +
    facet_grid(. ~ sex) +   
    labs(
      x = &amp;quot;Year&amp;quot;,
      y = &amp;quot;Salary (SEK/month)&amp;quot;
    ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-7&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-7-1.png&#34; alt=&#34;Lowest F-value, Assemblers&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Lowest F-value, Assemblers
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;-lm (log(salary) ~ year_n + poly(age_n, 3, raw = T), data = temp)

summod &amp;lt;- tidy(summary (model))

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = age_n,y = age_n * summod$estimate[3] + summod$estimate[4] * age_n^2 + summod$estimate[5] * age_n^3)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-8&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-8-1.png&#34; alt=&#34;Model fit, Assemblers, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 6: Model fit, Assemblers, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pdx &amp;lt;- deriv(as.polynomial(c(0, summod$estimate[3], summod$estimate[4], summod$estimate[5])))

temp %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n, y = summod$estimate[2] + pdx[1] + pdx[2] * age_n + pdx[3] * age_n^2)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary raise (%)&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-9&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-9-1.png&#34; alt=&#34;Model fit, Assemblers, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 7: Model fit, Assemblers, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tb %&amp;gt;%
  filter(`occuptional  (SSYK 2012)` == &amp;quot;161 Financial and insurance managers&amp;quot;)

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = age)) +
    facet_grid(. ~ sex) + 
      labs(
        x = &amp;quot;Year&amp;quot;,
        y = &amp;quot;Salary (SEK/month)&amp;quot;
      ) &lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-10&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-10-1.png&#34; alt=&#34;Highest yearly salary increase, Financial and insurance managers&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 8: Highest yearly salary increase, Financial and insurance managers
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;- lm (log(salary) ~ year_n + poly(age_n, 3, raw = T), data = temp)

summod &amp;lt;- tidy(summary (model))

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = age_n,y = age_n * summod$estimate[3] + summod$estimate[4] * age_n^2 + summod$estimate[5] * age_n^3)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-11&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-11-1.png&#34; alt=&#34;Model fit, Financial and insurance managers, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 9: Model fit, Financial and insurance managers, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pdx &amp;lt;- deriv(as.polynomial(c(0, summod$estimate[3], summod$estimate[4], summod$estimate[5])))

temp %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n, y = summod$estimate[2] + pdx[1] + pdx[2] * age_n + pdx[3] * age_n^2)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary raise (%)&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-12&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-12-1.png&#34; alt=&#34;Model fit, Financial and insurance managers, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 10: Model fit, Financial and insurance managers, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;temp &amp;lt;- tb %&amp;gt;%
  filter(`occuptional  (SSYK 2012)` == &amp;quot;523 Cashiers and related clerks&amp;quot;)
temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = year_n,y = salary, colour = age)) +
    facet_grid(. ~ sex) + 
    labs(
      x = &amp;quot;Year&amp;quot;,
      y = &amp;quot;Salary (SEK/month)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-13&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-13-1.png&#34; alt=&#34;Lowest yearly salary increase, Cashiers and related clerks&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 11: Lowest yearly salary increase, Cashiers and related clerks
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;model &amp;lt;-lm (log(salary) ~ year_n + poly(age_n, 3, raw = T), data = temp)

summod &amp;lt;- tidy(summary (model))

temp %&amp;gt;%
  ggplot () +
    geom_point (mapping = aes(x = age_n,y = age_n * summod$estimate[3] + summod$estimate[4] * age_n^2 + summod$estimate[5] * age_n^3)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-14&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-14-1.png&#34; alt=&#34;Model fit, Cashiers and related clerks, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 12: Model fit, Cashiers and related clerks, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pdx &amp;lt;- deriv(as.polynomial(c(0, summod$estimate[3], summod$estimate[4], summod$estimate[5])))

temp %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n, y = summod$estimate[2] + pdx[1] + pdx[2] * age_n + pdx[3] * age_n^2)) +
    labs(
      x = &amp;quot;Age&amp;quot;,
      y = &amp;quot;Salary raise (%)&amp;quot;
    )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-15&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-12-02-the-significance-of-experience-on-the-salary-in-sweden-a-comparison-between-different-occupational-groups_files/figure-html/unnamed-chunk-15-1.png&#34; alt=&#34;Model fit, Cashiers and related clerks, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 13: Model fit, Cashiers and related clerks, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a href=&#34;https://www.r-bloggers.com/&#34; class=&#34;uri&#34;&gt;https://www.r-bloggers.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://rweekly.org&#34; class=&#34;uri&#34;&gt;https://rweekly.org&lt;/a&gt;&lt;/p&gt;
`</description>
    </item>
    
    <item>
      <title>The significance of experience on the salary of engineers in Sweden</title>
      <link>/2019/11/22/the-significance-of-experience-on-the-salary-of-engineers-in-sweden/</link>
      <pubDate>Fri, 22 Nov 2019 00:00:00 +0000</pubDate>
      
      <guid>/2019/11/22/the-significance-of-experience-on-the-salary-of-engineers-in-sweden/</guid>
      <description>`


&lt;p&gt;What causes the salary to change during the working life of engineers in Sweden?&lt;/p&gt;
&lt;p&gt;I will examine data from Statistics Sweden to see what information you can interpret from it.&lt;/p&gt;
&lt;p&gt;Statistics Sweden is the Swedish government agency responsible for producing official statistics regarding Sweden, &lt;a href=&#34;https://www.scb.se/en/&#34; class=&#34;uri&#34;&gt;https://www.scb.se/en/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;“Everybody should have the opportunity to find facts and break the myths with our statistics!” Statistics Sweden twitter account, sverigeisiffror.&lt;/p&gt;
&lt;p&gt;Salaries are reported for every occupational group SSYK (Standard for Swedish occupational classification). I will examine SSYK 214, architects, engineers and related professionals.&lt;/p&gt;
&lt;p&gt;First, define libraries and functions.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library (tidyverse) 
## -- Attaching packages -------------------------------------------- tidyverse 1.2.1 --
## v ggplot2 3.2.0     v purrr   0.3.2
## v tibble  2.1.3     v dplyr   0.8.3
## v tidyr   0.8.3     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.4.0
## -- Conflicts ----------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
library (broom) 
library (car)
## Loading required package: carData
## 
## Attaching package: &amp;#39;car&amp;#39;
## The following object is masked from &amp;#39;package:dplyr&amp;#39;:
## 
##     recode
## The following object is masked from &amp;#39;package:purrr&amp;#39;:
## 
##     some
library (splines)
#install_github(&amp;quot;ZheyuanLi/SplinesUtils&amp;quot;)
library(SplinesUtils)

readfile &amp;lt;- function (file1){  
  read_csv (file1, col_types = cols(), locale = readr::locale (encoding = &amp;quot;latin1&amp;quot;), na = c(&amp;quot;..&amp;quot;, &amp;quot;NA&amp;quot;)) %&amp;gt;%  
    gather (starts_with(&amp;quot;19&amp;quot;), starts_with(&amp;quot;20&amp;quot;), key = &amp;quot;year&amp;quot;, value = salary) %&amp;gt;%  
    drop_na() %&amp;gt;%  
    mutate (year_n = parse_number (year))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The data table is downloaded from Statistics Sweden. It is saved as a comma-delimited file without heading, 00000031.csv, &lt;a href=&#34;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&#34; class=&#34;uri&#34;&gt;http://www.statistikdatabasen.scb.se/pxweb/en/ssd/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The table: Average monthly pay (total pay), non-manual workers private sector (SLP), SEK by occupational group (SSYK), age, sex and year. Year 2014 - 2018&lt;/p&gt;
&lt;p&gt;The average age within each age group is used as a numeric value for graphical presentation and the linear model.&lt;/p&gt;
&lt;p&gt;As the salary increases exponentially each year, I have used the logarithm for years in my model.&lt;/p&gt;
&lt;p&gt;As a proxy for experience years since graduation can be used. I will simplify by using age as a proxy for experience. I will use a B-spline function to approximate the increase in salaries over age. Spline function is used instead of a polynomial to avoid oscillation.&lt;/p&gt;
&lt;p&gt;We expect that both years and age are important factors on the salary. As a null hypothesis, we assume that years and age is not related to the salary and examine if we can reject this hypothesis with the data from Statistics Sweden.&lt;/p&gt;
&lt;p&gt;Every year the annual salary negotiation will increase the salaries. As age increases, we acquire more skill at work.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb &amp;lt;- readfile(&amp;quot;00000031.csv&amp;quot;) %&amp;gt;% 
  rowwise() %&amp;gt;% 
  mutate(age_l = unlist(lapply(strsplit(substr(age, 1, 5), &amp;quot;-&amp;quot;), strtoi))[1]) %&amp;gt;%
  rowwise() %&amp;gt;% 
  mutate(age_h = unlist(lapply(strsplit(substr(age, 1, 5), &amp;quot;-&amp;quot;), strtoi))[2]) %&amp;gt;%
  mutate(age_n = (age_l + age_h) / 2) 
   
tb %&amp;gt;%
  ggplot () +  
    geom_point (mapping = aes(x = year_n,y = salary, colour = age, shape=sex)) + 
  labs(
    x = &amp;quot;Year&amp;quot;,
    y = &amp;quot;Salary (SEK/month)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-2&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-2-1.png&#34; alt=&#34;SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;    
model &amp;lt;- lm (log(salary) ~ year_n + sex + bs(age_n, knots = c(30, 40, 50, 60)), data = tb)

tb &amp;lt;- bind_cols(tb, as_tibble(exp(predict(model, tb, interval = &amp;quot;confidence&amp;quot;))))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;From the summary table of the linear model, we can see that the wages have increased by 1,91 % +/- 0,35 % per year with 95 % confidence, holding age as constant. The R-value from the Anova table for years is 120, sufficient for rejecting the null hypothesis that years has no effect on the salary. Holding year as constant, the p values for age are small (&amp;lt; 2e-16) and the R-value from the Anova table value for age is 703, sufficient for rejecting the null hypothesis that experience has no effect on the salary. The adjusted R-squared value is 0,984 implying a good fit of the model.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb %&amp;gt;%
  ggplot () +  
    geom_point (mapping = aes(x = year_n,y = fit, colour = age, shape=sex)) + 
  labs(
    x = &amp;quot;Year&amp;quot;,
    y = &amp;quot;Salary (SEK/month)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-3&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-3-1.png&#34; alt=&#34;Model fit, SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 2: Model fit, SSYK 214, Architects, engineers and related professionals, Year 2014 - 2018
&lt;/p&gt;
&lt;/div&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;    
summary(model) %&amp;gt;%  
  tidy() %&amp;gt;%
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Summary from linear model fit&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;Summary from linear model fit&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;estimate&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;std.error&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;(Intercept)&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-28.1818464&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3.5078741&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-8.0338820&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;year_n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0190896&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0017400&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10.9709680&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sexwomen&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-0.0338703&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0050397&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;-6.7207107&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0136922&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0224921&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.6087566&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5443286&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))2&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.2417694&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0207156&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11.6708804&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4589440&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0172130&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26.6625840&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4963401&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0176805&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.0727805&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))5&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.5045782&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0195688&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;25.7848966&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))6&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4878569&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0169888&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28.7164274&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.4850548&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0143718&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33.7504146&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0000000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
summary(model)$r.squared   
## [1] 0.9839054
  
Anova(model, type=2) %&amp;gt;% 
  tidy() %&amp;gt;% 
  knitr::kable( 
  booktabs = TRUE,
  caption = &amp;#39;Anova report from linear model fit&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;caption&gt;&lt;span id=&#34;tab:unnamed-chunk-3&#34;&gt;Table 1: &lt;/span&gt;Anova report from linear model fit&lt;/caption&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;term&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;sumsq&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;df&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;statistic&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;p.value&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;year_n&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0687831&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;120.36214&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;sex&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0258120&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;1&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;45.16795&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;bs(age_n, knots = c(30, 40, 50, 60))&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.8136569&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;703.36608&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;Residuals&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.0480033&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;84&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;NA&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Let’s have a look at the spline function from the regression model. I use the package SplineUtils to extract the polynomial train from the model coefficients.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;myspline &amp;lt;- RegBsplineAsPiecePoly(model, &amp;quot;bs(age_n, knots = c(30, 40, 50, 60))&amp;quot;)

tibble(age_n = 21:65) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n,y = predict(myspline, age_n))) +
  labs(
    x = &amp;quot;Age&amp;quot;,
    y = &amp;quot;Salary&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-4&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-4-1.png&#34; alt=&#34;Model fit, SSYK 214, Correlation between age and salary&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 3: Model fit, SSYK 214, Correlation between age and salary
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The derivative of the spline function for age is equal to the annual salary raise that comes from experience. I also add the salary raise that comes from the annual salary negotiation resulting in the total salary increase distributed over age.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;summod &amp;lt;- tidy(summary (model))

myfun &amp;lt;- function(x){
  return (predict(myspline, x, deriv = 1) + summod$estimate[2])
}

tibble(age_n = 21:65) %&amp;gt;%
  ggplot () + 
    geom_point (mapping = aes(x = age_n,y = myfun(age_n))) +
  labs(
    x = &amp;quot;Age&amp;quot;,
    y = &amp;quot;Salary raise (%)&amp;quot;
  )&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-5&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-5-1.png&#34; alt=&#34;Model fit, SSYK 214, The derivative for age&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 4: Model fit, SSYK 214, The derivative for age
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Now. let´s perform some diagnostics on the model. First, a look at the residuals for the model shows no apparent problem.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
plot(model, which = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-6&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-6-1.png&#34; alt=&#34;Residuals vs Fitted of model fit&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 5: Residuals vs Fitted of model fit
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The Normal Q-Q shows some possible outliers.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
plot(model, which = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-7&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-7-1.png&#34; alt=&#34;Normal Q-Q&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 6: Normal Q-Q
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Again, the Standardised residuals show some possible outliers.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
plot(model, which = 3)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-8&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-8-1.png&#34; alt=&#34;Scale-Location&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 7: Scale-Location
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The outliers are also found in the Leverage plot.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;
plot(model, which = 5)&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;figure&#34;&gt;&lt;span id=&#34;fig:unnamed-chunk-9&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;/post/2019-11-22-the-significance-of-experience-on-the-salary-of-engineers-in-sweden_files/figure-html/unnamed-chunk-9-1.png&#34; alt=&#34;Residuals vs Leverage&#34; width=&#34;672&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 8: Residuals vs Leverage
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The outliers 38, 56 and 75 are small groups with larger variance at either end of the age spectrum. Record 72 are women age 55-59.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tb[38,]$age
## [1] &amp;quot;18-24 years&amp;quot;
tb[56,]$age
## [1] &amp;quot;65-66 years&amp;quot;
tb[75,]$age
## [1] &amp;quot;65-66 years&amp;quot;

tb[72,]
## Source: local data frame [1 x 12]
## Groups: &amp;lt;by row&amp;gt;
## 
## # A tibble: 1 x 12
##   `occuptional  (~ age   sex   year  salary year_n age_l age_h age_n    fit
##   &amp;lt;chr&amp;gt;            &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;  &amp;lt;dbl&amp;gt;  &amp;lt;dbl&amp;gt; &amp;lt;int&amp;gt; &amp;lt;int&amp;gt; &amp;lt;dbl&amp;gt;  &amp;lt;dbl&amp;gt;
## 1 214 Engineering~ 55-5~ women 2017   45000   2017    55    59    57 48433.
## # ... with 2 more variables: lwr &amp;lt;dbl&amp;gt;, upr &amp;lt;dbl&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Wage statistics&lt;/p&gt;
&lt;p&gt;The Mediation Institute is responsible for Sweden’s official salary statistics. This applies to three types of statistics: cyclical wage statistics, wage structure statistics and statistics supplied to the European statistical body Eurostat, &lt;a href=&#34;https://www.mi.se/other-languages/about-the-mediation-office-the-swedish-model-and-wage-statistics-in-english/&#34; class=&#34;uri&#34;&gt;https://www.mi.se/other-languages/about-the-mediation-office-the-swedish-model-and-wage-statistics-in-english/&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The statistics are collected and processed by Statistics Sweden. It is reported both on Statistics Sweden’s website and the Mediation Institute’s website.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.r-bloggers.com/&#34; class=&#34;uri&#34;&gt;https://www.r-bloggers.com/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://rweekly.org&#34; class=&#34;uri&#34;&gt;https://rweekly.org&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Last edited: 2019-12-10&lt;/p&gt;
`</description>
    </item>
    
  </channel>
</rss>